<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>HTTP Transfer Mechanism</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body id="_http_architecture" class="book">
<div id="header">
<h1>HTTP Transfer Mechanism</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#http_messages_ussd_pull">1. HTTP Message Structure - USSD Pull</a></li>
<li><a href="#_http_messages_ussd_push">2. HTTP Message Structure - USSD Push</a></li>
<li><a href="#http-payload">3. HTTP Payload</a>
<ul class="sectlevel2">
<li><a href="#xml-structure">3.1. XML Structure</a></li>
<li><a href="#_attributes">3.2. Dialog Attributes</a></li>
<li><a href="#child-elements">3.3. Child Elements</a></li>
<li><a href="#_xml_payload_examples">3.4. Typical usage of USSD application originated XML payload.</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Restcomm USSD GATEWAY supports implementation of HTTP 1.1 standards and acts as a HTTP Client invoking the HTTP Application deployed on the third-party Application Server.
The <code>HTTP Request/Response</code> carries XML payload with USSD specific information.</p>
</div>
<div class="paragraph">
<p>The HTTP callback mechanism allows the third-party Application to be agnostic to Operating System, Programming Language and Framework.
The third-party Application could be one of the following technologies on any Operating System:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Apache Tomcat, JBoss AS, Oracle Application Server, IBM Websphere etc for JSP/Servlet on Java</p>
</li>
<li>
<p>PHP</p>
</li>
<li>
<p>Microsoft IIS for ASP</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>HTTP errors are supported and recognized by the USSD GATEWAY</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http_messages_ussd_pull"><a class="anchor" href="#http_messages_ussd_pull"></a>1. HTTP Message Structure - USSD Pull</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The diagram below depicts an example message sequence for interacting with the Restcomm USSD GATEWAY HTTP API.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/http-call-flow-USSD-Pull.png" alt="http call flow USSD Pull">
</div>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When the subscriber initiates a USSD Request, the HLR sends a <code>MAP_PROCESS_UNSTRUCTURED_SS_REQUEST</code> to the USSD Gateway.</p>
</li>
<li>
<p>Upon receipt of the <code>MAP_PROCESS_UNSTRUCTURED_SS_REQUEST</code> of type <code>Begin</code>, USSD GATEWAY  invokes the third-party Application through a <code>HTTP POST Request</code>, carrying an XML Payload with USSD specific information.
The XML Structure of this payload is explained in the sections below.</p>
</li>
<li>
<p>The third-party Application will now get a new Session and maintain it till the last response.
The Application will send a <code>HTTP Response</code>, carrying an XML Payload, to the USSD GATEWAY .</p>
</li>
<li>
<p>The USSD GATEWAY will send a <code>MAP_UNSTRUCTURED_SS_REQUEST</code> of type <code>Continue</code> to the HLR.</p>
</li>
<li>
<p>The Subscriber will receive a menu to choose from and reply.
When the subscriber replies, the HLR will send a <code>MAP_UNSTRUCTURED_SS_RESPONSE</code> of type <code>Continue</code> to the USSD GATEWAY .</p>
</li>
<li>
<p>The USSD GATEWAY will send a <code>HTTP POST Request</code>, carrying an XML Payload, to the third-party Application in the same session.</p>
</li>
<li>
<p>Based on the input from the subscriber, the third-party Application will send a final response (<code>HTTP Response</code>, carrying an XML Payload) and invalidate the session.</p>
</li>
<li>
<p>The USSD GATEWAY will send a <code>MAP_PROCESS_UNSTRUCTURED_SS_RESPONSE</code> of type <code>End</code> to the HLR.
Consequently, the subscriber will receive a final response.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_http_messages_ussd_push"><a class="anchor" href="#_http_messages_ussd_push"></a>2. HTTP Message Structure - USSD Push</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For USSD PUSH, the third party application should send a HTTP POST request to the Restcomm USSD GATEWAY .
The URL for sending this is <a href="http://&lt;bind" class="bare">http://&lt;bind</a> address of JBoss&gt;:8080/mobicents.
The diagram below depicts an example message sequence (USSD Push) for interacting with the Restcomm USSD GATEWAY HTTP API.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/http-call-flow-USSD-Push.png" alt="http call flow USSD Push">
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="http-payload"><a class="anchor" href="#http-payload"></a>3. HTTP Payload</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="xml-structure"><a class="anchor" href="#xml-structure"></a>3.1. XML Structure</h3>
<div class="paragraph">
<p>The <code>HTTP Request</code>/<code>Response</code> carries XML Payload with USSD specific information as defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="Begin" appCntx="networkUnstructuredSsContext_version2"
	networkId="0" localId="1" remoteId="1" mapMessagesSize="1"
	returnMessageOnError="false"&gt;
	....
	....
	....
&lt;/dialog&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_attributes"><a class="anchor" href="#_attributes"></a>3.2. Dialog Attributes</h3>
<div class="paragraph">
<p>The XML element <code>&lt;dialog&gt;</code> contains various attributes to represent the state and the parameters of the Dialog.
Some of them are mandatory while others are optional.
This section explains in detail all possible attributes and what they represent.
The list of mandatory attributes that a USSD application must supply will be described for an each concrete response.</p>
</div>
<div class="dlist">
<div class="title">Parameters</div>
<dl>
<dt class="hdlist1">type</dt>
<dd>
<p>Represents the state of the Dialog.
This parameter is for information only and is not used by the USSD GATEWAY to take any decision on the fate of the underlying MAP Dialog.
The possible values for 'type' are: <code>Unidirectional, Begin, End, Continue, Abort, Unknown.</code>				You do not need to supply this parameter in payload from HTTP App.</p>
</dd>
<dt class="hdlist1">appCntx</dt>
<dd>
<p>Represents the MAP Application Context for USSD GW request.
Now it always "networkUnstructuredSsContext_version2". You do not need to supply this parameter in payload from HTTP App.
For outgoung USSD operations it is always networkUnstructuredSsContext version 2.
For outgoing SRI request an initial MAP operation version is defined by the 'maxmapv' parameter configured in <a href="#_setting_ussd_maxmapv">[_setting_ussd_maxmapv]</a>.</p>
</dd>
<dt class="hdlist1">networkId</dt>
<dd>
<p>Represents a networkId value.
USSD Gateway can be connected to multiple operators/network at same time.
For each operator unique networkId is assigned.
In the initial PUSH (unstructuredSS-Request or unstructuredSS-Notify) message HTTP app can specify networkId parameter for forsing of usage of desired network operator.
If this value is missed then the default value ("0") will be used.</p>
</dd>
<dt class="hdlist1">localId</dt>
<dd>
<p>Represents the local TCAP transaction ID.
You do not need to supply this parameter in payload from HTTP App because localId values for all outgoing MAP dialogs is assigned by TCAP stack itself.
All subsequent messages from the USSD Gateway will have the actual value.</p>
</dd>
<dt class="hdlist1">remoteId</dt>
<dd>
<p>Represents the remote TCAP transaction ID.
You do not need to supply this parameter in payload from HTTP App.</p>
</dd>
<dt class="hdlist1">mapMessagesSize</dt>
<dd>
<p>Represents the actual number of MAP messages carried in the &lt;dialog&gt;. This value can be 0 if no MAP messages are carried or 1 when a USSD message is present.
This parameter is mandatory in payload from HTTP App and is usually "1" when you are sending a message or "0" for an empty TC-END response in PUSH case.</p>
</dd>
<dt class="hdlist1">returnMessageOnError</dt>
<dd>
<p>For USSD GW originated XMP payload this parameter corresponds to SCCP message returnMessageOnError parameter.
You can supply this parameter in payload from HTTP App.
This will affect to outgoing SCCP messages.
(SCCP will return the notification is the message has non been delivered to the peer). Mostly we do not need to specify this parameter.
By default this is true.</p>
</dd>
<dt class="hdlist1">prearrangedEnd</dt>
<dd>
<p>This parameter can only be present in payload from HTTP App.
If this parameter is present, it means the underlying TCAP Dialog will be closed.
The value can be true or false.
If it is false, the messages will be sent to peer and the TCAP dialog ended.
If it is true, all the messages in the Dialog are dropped and the Dialog is closed without informing peer.
If this parameter is not present, all the messages in the Dialog are sent to peer as TCAP Continue.
If you do not want to close dialog this step do not include this parameter.
If you want to close dialog this step include this parameter with value "false".</p>
</dd>
<dt class="hdlist1">mapAbortProviderReason</dt>
<dd>
<p>If this parameter is present, it means the underlying Dialog is Provider Aborted.
The example below will describe in detail:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="Unknown" localId="12" remoteId="13" mapMessagesSize="0"
mapAbortProviderReason="SupportingDialogueTransactionReleased"
returnMessageOnError="false"&gt;
	&lt;errComponents/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The possible values for <code>mapAbortProviderReason</code> are <code>ProviderMalfunction, SupportingDialogueTransactionReleased, ResourceLimitation, MaintenanceActivity, VersionIncompatibility, AbnormalMAPDialogueLocal, AbnormalMAPDialogueFromPeer</code> and <code>InvalidPDU</code>.
  You do not need to supply this parameter in payload from HTTP App.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">mapRefuseReason</dt>
<dd>
<p>If this parameter is present, it means the underlying Dialog is refused by peer.
The example below will describe in detail:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="Unknown" localId="12" remoteId="13" mapMessagesSize="0"
mapRefuseReason="NoReasonGiven" returnMessageOnError="false"&gt;
	&lt;errComponents/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The possible values for <code>mapRefuseReason</code> are <code>ApplicationContextNotSupported, InvalidDestinationReference, InvalidOriginatingReference, NoReasonGiven, RemoteNodeNotReachable</code> and <code>PotentialVersionIncompatibility</code>.
  You do not need to supply this parameter in payload from HTTP App.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">mapUserAbortChoice</dt>
<dd>
<p>If this parameter is present, it means peer user has aborted Dialog.
The example below will describe in detail:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="Unknown" localId="12" remoteId="13" mapMessagesSize="0"
mapUserAbortChoice="isUserSpecificReason" returnMessageOnError="false"&gt;
	&lt;errComponents/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The possible values for <code>mapUserAbortChoice</code> are <code>isProcedureCancellationReason_handoverCancellation, isProcedureCancellationReason_radioChannelRelease, isProcedureCancellationReason_networkPathRelease, isProcedureCancellationReason_callRelease,
  isProcedureCancellationReason_associatedProcedureFailure, isProcedureCancellationReason_tandemDialogueRelease, isProcedureCancellationReason_remoteOperationsFailure, isResourceUnavailableReason_shortTermResourceLimitation, isResourceUnavailableReason_longTermResourceLimitation, isUserResourceLimitation</code> and <code>isUserSpecificReason</code>.
  Even the HTTP App can Abort a specific Dialog by setting this value and sending it to the USSD Gateway.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">dialogTimedOut</dt>
<dd>
<p>If this parameter is present, it means the underlying TCAP Dialog has timedout.
The deafult value of TCAP Dialog timeout should always be greater than USSD Timeout value set in <a href="#_set_dialogtimeout">[_set_dialogtimeout]</a>.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog type="Unknown" localId="12" remoteId="13" mapMessagesSize="0" dialogTimedOut="true"
returnMessageOnError="false"&gt;
	&lt;errComponents/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>You do not need to supply this parameter in payload from HTTP App.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">emptyDialogHandshake</dt>
<dd>
<p>This parameter can only be present in payload from HTTP App.
This is used only when USSD gateway is initiating Dialog (Push case).  This parameter indicates that USSD Gateway should firstly send empty dialog  (without USSD Payload) and only once dialog is accepted by peer,  USSD message should be sent.</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog mapMessagesSize="1" emptyDialogHandshake="true"&gt;
...
...
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">customInvokeTimeOut</dt>
<dd>
<p>This parameter can only be present in payload from HTTP App.
Each MAP operation has its own default invoke timeout, for example for the unstructuredSS-Request MAP operation default invoke timeout is 10 min.
HTTP App can set custom invoke timeout for each USSD message it sends to other end by using of this parameter (value is in milliseconds).</p>
</dd>
<dt class="hdlist1">invokeTimedOut</dt>
<dd>
<p>This parameter indicates the invoke sent by USSD Gw has timed out.
This generally means user has taken longer than expected to respond to USSD message.
HTTP App can set custom invoke timeout for each ussd message by setting  customInvokeTimeOut explained above.
Once invoke timesout, USSD gateway will  automatically abort the Dialog and send corresponding message to HTTP App.
You do not need to supply this parameter in payload from HTTP App.</p>
</dd>
<dt class="hdlist1">userObject</dt>
<dd>
<p>Application can set some user specific String value that the USSD gateway  will always send back in corresponding messages exchanged:</p>
</dd>
</dl>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="Continue" appCntx="networkUnstructuredSsContext_version2"
localId="12" remoteId="13" mapMessagesSize="1" returnMessageOnError="false"
userObject="123456789"&gt;
....
....
&lt;/dialog&gt;</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="child-elements"><a class="anchor" href="#child-elements"></a>3.3. Child Elements</h3>
<div class="paragraph">
<p>The element &lt;dialog&gt; may contain any of these child elements but the order has to be respected.
The possible child elements and the order to be followed, if present, must be as in the below list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>SCCP Address</p>
</li>
<li>
<p>AddressString</p>
</li>
<li>
<p>Error Components</p>
</li>
<li>
<p>processUnstructuredSSRequest_Request</p>
</li>
<li>
<p>processUnstructuredSSRequest_Response</p>
</li>
<li>
<p>unstructuredSSRequest_Request</p>
</li>
<li>
<p>unstructuredSSRequest_Response</p>
</li>
<li>
<p>unstructuredSSNotify_Request</p>
</li>
<li>
<p>unstructuredSSNotify_Response</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_child_sccp_address"><a class="anchor" href="#_child_sccp_address"></a>3.3.1. SCCP Address</h4>
<div class="paragraph">
<p>Dialog carries SCCP information like &lt;localAddress&gt;, which is the SCCP Address of USSD gateway and &lt;remoteAddress&gt;, which is the SCCP address from where the Dialog is initiated, in case if this Dialog is received from other side (USSD Pull) or SCCP Address of remote side, incase of USSD Gateway acting as Proxy.</p>
</div>
<div class="paragraph">
<p>Both the elements are optional and if they are not passed, the USSD Gateway will get the values from the Global Title configured from <a href="#_setting_ussd_gt">[_setting_ussd_gt]</a> for &lt;localAddress&gt;. If the USSD Gateway is acting as proxy, it mandatory to set the &lt;remoteAddress&gt;, else this parameter is ignored.</p>
</div>
<div class="paragraph">
<p>Attributes of SCCP (localAddress and remoteAddress) address are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>pc: Mandatory parameter.
Represents the point code.</p>
</li>
<li>
<p>ssn: Mandatory parameter.
Represents the Sub System Number.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Child elements of SCCP Address are &lt;ai&gt; and &lt;gt&gt;, where &lt;ai&gt; is Address indicator and suggests if routing is based on PC + SSN or GT.
If it is based on GT, include &lt;gt&gt; element.</p>
</div>
<div class="paragraph">
<p>Please refer to the examples below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>a) Routing based on PC + SSN

	&lt;localAddress pc="1" ssn="8"&gt;
		&lt;ai value="67"/&gt;
	&lt;/localAddress&gt;

b) Routing based on GT
	&lt;localAddress pc="0" ssn="146"&gt;
		&lt;ai value="18"/&gt;
		&lt;gt type="GlobalTitle0100" tt="0" es="2" np="1" nai="4" digits="9960639902"/&gt;
	&lt;/localAddress&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Different Gloabl Titles are <code>GlobalTitle0001</code>, <code>GlobalTitle0010</code>, <code>GlobalTitle0011</code> and <code>GlobalTitle0100</code>.
For more details about SCCP, please refer to the jSS7 Admin Guide included in the documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="_child_address_string"><a class="anchor" href="#_child_address_string"></a>3.3.2. AddressString</h4>
<div class="paragraph">
<p>Dialog carries the AddressString information like &lt;destinationReference&gt; and &lt;originationReference&gt;. The attributes of AddressString are defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"nai" : nature of address indicator. The values are
	0 : unknown
	1 : international_number
	2 : national_significant_number
	3 : network_specific_number
	4 : subscriber_number
	5 : reserved
	6 : abbreviated_number
	7 : reserved_for_extension

"npi" : Numbering plan. The values are
	0 : unknown
	1 : ISDN
	2 : spare_2
	3 : data
	4 : telex
	5 : spare_5
	6 : land_mobile
	7 : spare_7
	8 : national
	9 : private_plan
	15 : reserved

"number" : The actual number

The XML example is
&lt;destinationReference number="204208300008002" nai="international_number" npi="land_mobile"/&gt;
&lt;originationReference number="204208300008002" nai="international_number" npi="ISDN"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_errorcomponents"><a class="anchor" href="#_errorcomponents"></a>3.3.3. Error Components</h4>
<div class="paragraph">
<p>If peer reports <code>ErrorComponents</code>, same is forwarded to the Application through the child element <code>&lt;errComponents/&gt;</code>.
The example of payload is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;dialog type="End" networkId="0" localId="0" remoteId="0" mapMessagesSize="0" sriPart="true" emptyDialogHandshake="true" returnMessageOnError="false"&gt;
	&lt;errComponents&gt;
		&lt;invokeId value="1"/&gt;
		&lt;errorComponent type="MAPErrorMessageAbsentSubscriberSM" errorCode="6"&gt;
			&lt;absentSubscriberDiagnosticSM value="IMSIDetached"/&gt;
		&lt;/errorComponent&gt;
	&lt;/errComponents&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="processunstructuredssrequest_request"><a class="anchor" href="#processunstructuredssrequest_request"></a>3.3.4. processUnstructuredSSRequest_Request</h4>
<div class="paragraph">
<p>This message is always sent by the USSD Gateway to the Application as a HTTP POST request or from the Application to the USSD Gateway if it is acting as Proxy.
The Application should always send back <code>processUnstructuredSSResponse</code> indicating that it is the last message of this dialog or can also send <code>unstructuredSSRequest</code> indicating that the Application is expecting more response from the user (menu structure).</p>
</div>
<div class="paragraph">
<p>The Attributes of <code>processUnstructuredSSRequest_Request</code> are defined below:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"invokeId" : All message types have the mandatory <code>invokeId</code> attribute helping to relate the response to request.
For example, <code>processUnstructuredSSResponse</code> will have the same <code>invokeId</code> as carried by <code>processUnstructuredSSRequest</code>.
Hence if the Application has a multi-level menu, it should store the <code>invokeId</code>, received in the <code>processUnstructuredSSRequest</code> in a HTTP Session, for later use.
Also for every new request in the same dialog, <code>invokeId</code> should be incremented by 1.
For example when the Application sends <code>unstructuredSSRequest</code> to a received <code>processUnstructuredSSRequest</code> with <code>invokeId</code> equal to zero, it should set the <code>invokeId</code> equal to 1 in <code>unstructuredSSRequest</code>.</p>
</li>
<li>
<p>"dataCodingScheme" : The Attribute <code>dataCodingScheme</code> is mandatory and represents the actual USSD Message. <code>dataCodingScheme</code> is the encoding parameter of the USSD Message.</p>
</li>
<li>
<p>"string" : The Attribute <code>string</code> is mandatory and represents the USSD String length.
In GSM 0902 160, octets are stated as the maximum length for the USSD String.
However due to underlying signalling layers the maximum length of the USSD string depends on the message and can be less than 160.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;processUnstructuredSSRequest_Request invokeId="0" dataCodingScheme="15" string="*234#"&gt;
	&lt;msisdn nai="international_number" npi="ISDN" number="79273605819"/&gt;
	&lt;alertingPattern size="1"&gt;
		&lt;value value="6"/&gt;
	&lt;/alertingPattern&gt;
&lt;/processUnstructuredSSRequest_Request&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Child elements of <code>processUnstructuredSSRequest_Request</code> are &lt;msisdn&gt; and &lt;alertingPattern&gt;. The child element &lt;msisdn&gt; is optional and included only if the actual MAP message received by the USSD Gateway carries this value.
This is MSISDN of the user who originated this request.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If &lt;msisdn&gt; is not included in processUnstructuredSSRequest, originationReference will be included in the dialog and this will be the MSISDN of the user originating the request.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>&lt;alertingPattern&gt; is also an optional attribute.</p>
</div>
</div>
<div class="sect3">
<h4 id="processunstructuredssrequest_response"><a class="anchor" href="#processunstructuredssrequest_response"></a>3.3.5. processUnstructuredSSRequest_Response</h4>
<div class="paragraph">
<p>This message is always sent by the Application to the USSD GateWay as a response to the received <code>processUnstructuredSSRequest</code> or <code>unstructuredSSResponse</code>.
If the USSD Gateway is acting as Proxy, this message is sent from the USSD Gateway to the Application.
This should always be the last message in the dialog.</p>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;processUnstructuredSSRequest_Response invokeId="0" dataCodingScheme="15" string="Thank You!"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unstructuredssrequest_request"><a class="anchor" href="#unstructuredssrequest_request"></a>3.3.6. unstructuredSSRequest_Request</h4>
<div class="paragraph">
<p>This message is sent by the Application to the USSD GateWay in response to the received <code>processUnstructuredSSRequest</code> or <code>unstructuredSSResponse</code> in case of USSD Pull.
In case of USSD Push, the Application can send this message to initiate a tree based menu push.
This indicates that the Application is expecting some response from the user.
If the USSD Gateway is acting as Proxy, this message is sent by the USSD Gateway to the Application.</p>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;unstructuredSSRequest_Request invokeId="0" dataCodingScheme="15" string="USSD String : Hello World&amp;#10; 1. Balance&amp;#10; 2. Texts Remaining"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unstructuredssrequest_response"><a class="anchor" href="#unstructuredssrequest_response"></a>3.3.7. unstructuredSSRequest_Response</h4>
<div class="paragraph">
<p>This message is sent by the USSD GateWay to the Application in HTTP POST request.
This is a response to <code>unstructuredSSRequest</code> sent by the Application earlier.
If the USSD Gateway acts as proxy, this message is sent by the Application to the USSD Gateway in response to <code>unstructuredSSRequest_Request</code> received by the Application.</p>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;unstructuredSSRequest_Response invokeId="0" dataCodingScheme="15" string="1"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="unstructuredssnotify_request"><a class="anchor" href="#unstructuredssnotify_request"></a>3.3.8. unstructuredSSNotify_Request</h4>
<div class="paragraph">
<p>This message is sent by the Application to the USSD GateWay to initiate USSD Push.
This is just to notify the user and no input is expected back from the user.
If the USSD Gateway is acting as proxy, this message is sent by USSD Gateway to the Application.</p>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
</div>
<div class="sect3">
<h4 id="unstructuredssnotify_response"><a class="anchor" href="#unstructuredssnotify_response"></a>3.3.9. unstructuredSSNotify_Response</h4>
<div class="paragraph">
<p>This message is sent by the USSD Gateway to the Application in response to <code>unstructuredSSNotify_Request</code> sent by the Application.
If the USSD Gateway is acting as proxy, the Application will send this message to the USSD Gateway.</p>
</div>
<div class="paragraph">
<p>The XML structure is defined below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;unstructuredSSRequest_Response invokeId="0"/&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="using-non-latin-menu"><a class="anchor" href="#using-non-latin-menu"></a>3.3.10. Using non-Latin menu</h4>
<div class="paragraph">
<p>If you wish to send non-Latin text (example, Cyrillic, Arabic, etc) then you must set the value of the attribute <code>dataCodingScheme</code> to "72" (unlike the case of latin/digits where this is set to 15). You must ensure that any message text that contains non-Latin symbols must be UTF-8 encoded.
The entire length of the message (in characters) must be less because this uses 2-byte encoding per character.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_payload_examples"><a class="anchor" href="#_xml_payload_examples"></a>3.4. Typical usage of USSD application originated XML payload.</h3>
<div class="paragraph">
<p>For USSD PULL case, a USSD application can usually issue following messages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>PROCESS_UNSTRUCTURED_SS_RESPONSE</p>
</li>
<li>
<p>UNSTRUCTURED_SS_REQUEST</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For USSD PUSH case, a USSD application can usually issue following messages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>UNSTRUCTURED_NOTIFY_REQUEST</p>
</li>
<li>
<p>UNSTRUCTURED_SS_REQUEST</p>
</li>
<li>
<p>RELEASE COMPLETE - finishing of a dialog</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We will discuss few payload examples in this section.</p>
</div>
<div class="sect3">
<h4 id="_xml_payload_examples_process_unstructured_ss_response"><a class="anchor" href="#_xml_payload_examples_process_unstructured_ss_response"></a>3.4.1. PULL case - PROCESS_UNSTRUCTURED_SS_RESPONSE</h4>
<div class="paragraph">
<p>Payload example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="1" prearrangedEnd="false"&gt;
  &lt;processUnstructuredSSRequest_Response invokeId="1" dataCodingScheme="15" string="Your balance is 1 USD"/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This message must finish PULL Dialog so we set "prearrangedEnd="false"". For USSD GW a count of internal messages is always 1, but this field is mandatory and we have to include it into a payload: mapMessagesSize="1". You have to also set "invokeId="1"" record which must be equal invokeId from processUnstructuredSSRequest_Request.
"dataCodingScheme" value is usually "15" (GSM7 encoding) or "72" (USC2 encoding). "string" is USSD string value.
Pay attention that as for GSM specification USSD string length has maximum length 182 characters for GSM7 coding and 80 characters for USC2 encoding.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xml_payload_examples_unstructured_ss_request"><a class="anchor" href="#_xml_payload_examples_unstructured_ss_request"></a>3.4.2. PULL case - UNSTRUCTURED_SS_REQUEST</h4>
<div class="paragraph">
<p>Payload example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="1"&gt;
  &lt;unstructuredSSRequest_Request dataCodingScheme="15" string="Press 1 for paying or press 2 for aborting"/&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>This message will continue PULL Dialog.
"userObject" attribute is optional.
You can use it for identification puposes.
This value will be return to USSD application with the all next xml payloads.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xml_payload_examples_unstructured_notify_request"><a class="anchor" href="#_xml_payload_examples_unstructured_notify_request"></a>3.4.3. PUSH case - UNSTRUCTURED_NOTIFY_REQUEST</h4>
<div class="paragraph">
<p>Payload example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="1"&gt;
  &lt;unstructuredSSNotify_Request dataCodingScheme="15" string="Your new balance is 34.38 AFN and expires on 30.07.2012. Cost of last event was 0.50 AFN."&gt;
    &lt;msisdn nai="international_number" npi="ISDN" number="11111111111111"/&gt;
  &lt;/unstructuredSSNotify_Request&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>You are initiating a PUSH dialog.
We need to include "msisdn" parameter which identifies a destination subscriber phone number (nai is "Nature of address", npi means "Numeric plan"). "msisdn" parameter must be included only in the first unstructuredSSNotify_Request or unstructuredSSRequest_Request of the PUSH dialog.</p>
</div>
</div>
<div class="sect3">
<h4 id="_xml_payload_examples_push_unstructured_ss_request"><a class="anchor" href="#_xml_payload_examples_push_unstructured_ss_request"></a>3.4.4. PUSH case - UNSTRUCTURED_SS_REQUEST</h4>
<div class="paragraph">
<p>Payload example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="1"&gt;
  &lt;unstructuredSSRequest_Request dataCodingScheme="15" string="Press 1 for paying or press 2 for aborting"&gt;
    &lt;msisdn nai="international_number" npi="ISDN" number="5444444444"/&gt;
  &lt;/unstructuredSSRequest_Request&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_xml_payload_examples_release_complete"><a class="anchor" href="#_xml_payload_examples_release_complete"></a>3.4.5. PUSH case - RELEASE COMPLETE - finishing dialog</h4>
<div class="paragraph">
<p>Payload example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="0" prearrangedEnd="false"&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>PUSH dialog can include one or more UNSTRUCTURED_NOTIFY_REQUEST or UNSTRUCTURED_SS_REQUEST.
After this USSD application must finish the dialog by this payload.
PUSH dialog always uses several HTTP request to create, continue and terminatie it.
For successfull processing it is needed to use a http cookie JSESSIONID.
First http response contains a session cookie like "Set-Cookie: JSESSIONID=1379BF8AF4DB8CACF444AEA6375AD85E; Path=/mobicents". Every next request must contain a tag like: "Cookie: JSESSIONID=1379BF8AF4DB8CACF444AEA6375AD85E" Every request (UNSTRUCTURED_SS_REQUEST and UNSTRUCTURED_NOTIFY_REQUEST) can contain extra parameter "customInvokeTimeout" in the dialog section to set up a custom invoke timeout (in milliseconds). For example (for 10 minutes invoke timeout):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;dialog mapMessagesSize="1" customInvokeTimeout="600000"&gt;
  &lt;unstructuredSSRequest_Request dataCodingScheme="15" string="Press 1 for paying or press 2 for aborting"&gt;
    &lt;msisdn nai="international_number" npi="ISDN" number="5444444444"/&gt;
  &lt;/unstructuredSSRequest_Request&gt;
&lt;/dialog&gt;</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-04-07 11:54:12 WEST
</div>
</div>
</body>
</html>
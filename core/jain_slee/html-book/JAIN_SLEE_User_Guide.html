<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<title>User Guide to Restcomm jDiameter 2.8.0-SNAPSHOT</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
</head>
<body class="book">
<div id="header">
<h1>User Guide to Restcomm jDiameter 2.8.0-SNAPSHOT</h1>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#preface">Preface</a></li>
<li><a href="#document-conventions">Document Conventions</a>
<ul class="sectlevel2">
<li><a href="#typographic-conventions">Typographic Conventions</a></li>
<li><a href="#pull-quote-conventions">Pull-quote Conventions</a></li>
<li><a href="#notes-and-warnings">Notes and Warnings</a></li>
</ul>
</li>
<li><a href="#provide-feedback-to-the-authors">Provide feedback to the authors!</a></li>
<li><a href="#_introduction">1. Introduction to Restcomm  JAIN SLEE</a></li>
<li><a href="#_install">2. Installing Restcomm  JAIN SLEE</a>
<ul class="sectlevel2">
<li><a href="#_preinstall_requirements_and_prerequisites">2.1. Pre-Install Requirements and Prerequisites</a></li>
<li><a href="#install-alternatives">2.2. Install Alternatives</a></li>
<li><a href="#_uninstall">2.3. Uninstall Restcomm  JAIN SLEE</a></li>
</ul>
</li>
<li><a href="#_configuration_and_running">3. Configuring and Running Restcomm  JAIN SLEE</a>
<ul class="sectlevel2">
<li><a href="#_server_profiles">3.1. Server Profiles</a></li>
<li><a href="#_running">3.2. Running Restcomm  JAIN SLEE</a></li>
<li><a href="#_configuration">3.3. Configuring Restcomm  JAIN SLEE</a></li>
<li><a href="#eventcontext-factory-configuration">3.4. EventContext Factory Configuration</a></li>
<li><a href="#_event_router_configuration">3.5. Event Router Statistics and Configuration</a></li>
<li><a href="#timer-facility-configuration">3.6. Timer Facility Configuration</a></li>
</ul>
</li>
<li><a href="#_management">4. Managing Restcomm  JAIN SLEE</a>
<ul class="sectlevel2">
<li><a href="#_management_jmx_agent">4.1. JAIN SLEE JMX Agent</a></li>
<li><a href="#_management_snmp_agent">4.2. SNMP Agent</a></li>
<li><a href="#_management_components">4.3. Managing JAIN SLEE Components</a></li>
<li><a href="#_management_persistent_file_deployer">4.4. Persistent Deployable Unit Management</a></li>
<li><a href="#_management_tools_ant_tasks">4.5. Ant Tasks</a></li>
<li><a href="#management-consoles">4.6. Management Consoles</a></li>
</ul>
</li>
<li><a href="#logging-traces-and-alarms">5. Logging, Traces and Alarms</a>
<ul class="sectlevel2">
<li><a href="#_log4j_service">5.1. Log4j Logging Service</a></li>
<li><a href="#alarm-facility">5.2. Alarm Facility</a></li>
<li><a href="#trace-facility">5.3. Trace Facility</a></li>
</ul>
</li>
<li><a href="#_clustering">6. Restcomm  JAIN SLEE Clustering</a>
<ul class="sectlevel2">
<li><a href="#_container_clustering">6.1. High Availability and Fault Tolerance</a></li>
<li><a href="#_container_clustering_fault_tolerant">6.2. Component Redundancy in Fault Tolerant Clusters</a></li>
<li><a href="#_container_clustering_components_management">6.3. Managing Components in Restcomm  JAIN SLEE Cluster</a></li>
</ul>
</li>
<li><a href="#_clustering_fault_tolerant_ra_api">7. Fault Tolerant Resource Adaptor API</a>
<ul class="sectlevel2">
<li><a href="#_fault_tolerant_resource_adaptor">7.1. The Fault Tolerant Resource Adaptor Object</a></li>
<li><a href="#_fault_tolerant_resource_adaptor_context">7.2. The Fault Tolerant Resource Adaptor Context</a></li>
</ul>
</li>
<li><a href="#_container_clustering_ra_activity_replication">8. Resource Adaptor Activity Replication</a></li>
<li><a href="#_slee_connection_factory">9. Firing Events from Java EE Applications</a>
<ul class="sectlevel2">
<li><a href="#_slee_connection_factory_intro">9.1. SLEE Connection Factory</a></li>
</ul>
</li>
<li><a href="#_slee_1_1_extensions">10. JAIN SLEE 1.1 Extensions</a>
<ul class="sectlevel2">
<li><a href="#_slee_1_1_extensions_sbbcontext">10.1. SbbContext Extension</a></li>
<li><a href="#_slee_1_1_extensions_cr">10.2. ChildRelation Extension</a></li>
<li><a href="#_slee_1_1_extensions_sbblo">10.3. SbbLocalObject Extension</a></li>
<li><a href="#_slee_1_1_extensions_profilecontext">10.4. ProfileContext Extension</a></li>
<li><a href="#_slee_1_1_extensions_aci">10.5. ActivityContextInterface Extension</a></li>
<li><a href="#_slee_1_1_extensions_library_references">10.6. Library References Extension</a></li>
</ul>
</li>
<li><a href="#advanced-topics">11. Advanced Topics</a>
<ul class="sectlevel2">
<li><a href="#_classloading">11.1. Class Loading</a></li>
<li><a href="#congestion-control">11.2. Congestion Control</a></li>
<li><a href="#_jpa_slee_profiles_mapping">11.3. JAIN SLEE 1.1 Profiles JPA Mapping</a></li>
<li><a href="#_testing_tck">11.4. Testing the JAIN SLEE 1.1 TCK</a></li>
<li><a href="#_eclipse_ide">11.5. Setting JAIN SLEE Source Code Projects in Eclipse IDE</a></li>
</ul>
</li>
<li><a href="#_jdk_installing_configuring_and_running">Appendix A: Java Development Kit (): Installing, Configuring and Running</a></li>
<li><a href="#_jboss_home_setup">Appendix B: Setting the JBOSS_HOME Environment Variable</a></li>
<li><a href="#_fault_tolerant_cluster_example">Appendix C: Fault Tolerant Clustering - A Concrete Example</a>
<ul class="sectlevel2">
<li><a href="#_ft_example_overview">Example Overview</a></li>
<li><a href="#_ft_example_step1">Creating Sbb entities</a></li>
<li><a href="#_ft_example_step2">Relaying the Message</a></li>
</ul>
</li>
<li><a href="#revision-history">Appendix D: Revision History</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="preface"><a class="anchor" href="#preface"></a>Preface</h2>
<div class="sectionbody">

</div>
</div>
<div class="sect1">
<h2 id="document-conventions"><a class="anchor" href="#document-conventions"></a>Document Conventions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This manual uses several conventions to highlight certain words and phrases and draw attention to specific pieces of information.</p>
</div>
<div class="paragraph">
<p>In PDF and paper editions, this manual uses typefaces drawn from the <a href="https://fedorahosted.org/liberation-fonts/">Liberation Fonts</a> set.
The Liberation Fonts set is also used in HTML editions if the set is installed on your system.
If not, alternative but equivalent typefaces are displayed.
Note: Red Hat Enterprise Linux 5 and later includes the Liberation Fonts set by default.</p>
</div>
<div class="sect2">
<h3 id="typographic-conventions"><a class="anchor" href="#typographic-conventions"></a>Typographic Conventions</h3>
<div class="paragraph">
<p>Four typographic conventions are used to call attention to specific words and phrases.
These conventions, and the circumstances they apply to, are as follows.</p>
</div>
<div class="paragraph">
<p><code>Mono-spaced Bold</code></p>
</div>
<div class="paragraph">
<p>Used to highlight system input, including shell commands, file names and paths.
Also used to highlight key caps and key-combinations.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
To see the contents of the file <em class="path">my_next_bestselling_novel</em> in your current working directory, enter the <code>cat my_next_bestselling_novel</code> command at the shell prompt and press <kbd>Enter</kbd> to execute the command.
</blockquote>
</div>
<div class="paragraph">
<p>The above includes a file name, a shell command and a key cap, all presented in Mono-spaced Bold and all distinguishable thanks to context.</p>
</div>
<div class="paragraph">
<p>Key-combinations can be distinguished from key caps by the hyphen connecting each part of a key-combination.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Press <kbd>Enter</kbd> to execute the command.</p>
</div>
<div class="paragraph">
<p>Press  to switch to the first virtual terminal.
Press  to return to your X-Windows session.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The first sentence highlights the particular key cap to press.
The second highlights two sets of three key caps, each set pressed simultaneously.</p>
</div>
<div class="paragraph">
<p>If source code is discussed, class names, methods, functions, variable names and returned values mentioned within a paragraph will be presented as above, in <code>Mono-spaced Bold</code>.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
File-related classes include <code class="class">filesystem</code> for file systems, <code class="class">file</code> for files, and <code class="class">dir</code> for directories.
Each class has its own associated set of permissions.
</blockquote>
</div>
<div class="paragraph">
<p><code class="app">Proportional Bold</code></p>
</div>
<div class="paragraph">
<p>This denotes words or phrases encountered on a system, including application names; dialogue box text; labelled buttons; check-box and radio button labels; menu titles and sub-menu titles.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Choose <span class="menu">System &gt; Preferences &gt; Mouse</span> from the main menu bar to launch <code class="app">Mouse Preferences</code>.
In the <span class="label">Buttons</span> tab, click the <span class="label">Left-handed mouse</span> check box and click <b class="button">Close</b> to switch the primary mouse button from the left to the right (making the mouse suitable for use in the left hand).</p>
</div>
<div class="paragraph">
<p>To insert a special character into a <code class="app">gedit</code> file, choose <span class="menu">Applications &gt; Accessories &gt; Character Map</span> from the main menu bar.
Next, choose <span class="menu">Search &gt; Find</span> from the <code class="app">Character Map</code> menu bar, type the name of the character in the <span class="label">Search</span> field and click <b class="button">Next</b>.
The character you sought will be highlighted in the <span class="label">Character Table</span>.
Double-click this highlighted character to place it in the <span class="label">Text to copy</span> field and then click the <b class="button">Copy</b> button.
Now switch back to your document and choose <span class="menu">Edit &gt; Paste</span> from the <code class="app">gedit</code> menu bar.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>The above text includes application names; system-wide menu names and items; application-specific menu names; and buttons and text found within a GUI interface, all presented in Proportional Bold and all distinguishable by context.</p>
</div>
<div class="paragraph">
<p>Note the menu:&gt;[] shorthand used to indicate traversal through a menu and its sub-menus.
This is to avoid the difficult-to-follow 'Select  from the <span class="menuseq"><span class="menu">Preferences</span>&#160;&#9656; <span class="menuitem">] sub-menu in the menu:System[</span></span> menu of the main menu bar' approach.</p>
</div>
<div class="paragraph">
<p><code>Mono-spaced Bold Italic</code> or <code class="app">Proportional Bold Italic</code></p>
</div>
<div class="paragraph">
<p>Whether Mono-spaced Bold or Proportional Bold, the addition of Italics indicates replaceable or variable text.
Italics denotes text you do not input literally or displayed text that changes depending on circumstance.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>To connect to a remote machine using ssh, type <code>ssh <a href="mailto:username@domain.name">username@domain.name</a></code> at a shell prompt.
If the remote machine is <em class="path">example.com</em> and your username on that machine is john, type <code>ssh <a href="mailto:john@example.com">john@example.com</a></code>.</p>
</div>
<div class="paragraph">
<p>The <code>mount -o remount file-system</code> command remounts the named file system.
For example, to remount the <em class="path">/home</em> file system, the command is <code>mount -o remount /home</code>.</p>
</div>
<div class="paragraph">
<p>To see the version of a currently installed package, use the <code>rpm -q package</code> command.
It will return a result as follows: <code>package-version-release</code>.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Note the words in bold italics above &mdash;username, domain.name, file-system, package, version and release.
Each word is a placeholder, either for text you enter when issuing a command or for text displayed by the system.</p>
</div>
<div class="paragraph">
<p>Aside from standard usage for presenting the title of a work, italics denotes the first use of a new and important term.
For example:</p>
</div>
<div class="quoteblock">
<blockquote>
When the Apache HTTP Server accepts requests, it dispatches child processes or threads to handle them.
This group of child processes or threads is known as a <em class="term">server-pool</em>.
Under Apache HTTP Server 2.0, the responsibility for creating and maintaining these server-pools has been abstracted to a group of modules called <em class="term">Multi-Processing Modules</em> (<em class="term">MPMs</em>). Unlike other modules, only one module from the MPM group can be loaded by the Apache HTTP Server.
</blockquote>
</div>
</div>
<div class="sect2">
<h3 id="pull-quote-conventions"><a class="anchor" href="#pull-quote-conventions"></a>Pull-quote Conventions</h3>
<div class="paragraph">
<p>Two, commonly multi-line, data types are set off visually from the surrounding text.</p>
</div>
<div class="paragraph">
<p>Output sent to a terminal is set in <code>Mono-spaced Roman</code> and presented thus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>books        Desktop   documentation  drafts  mss    photos   stuff  svn
books_tests  Desktop1  downloads      images  notes  scripts  svgs</pre>
</div>
</div>
<div class="paragraph">
<p>Source-code listings are also set in <code>Mono-spaced Roman</code> but are presented and highlighted as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.jboss.book.jca.ex1;

import javax.naming.InitialContext;

public class ExClient
{
   public static void main(String args[])
       throws Exception
   {
      InitialContext iniCtx = new InitialContext();
      Object         ref    = iniCtx.lookup("EchoBean");
      EchoHome       home   = (EchoHome) ref;
      Echo           echo   = home.create();

      System.out.println("Created Echo");

      System.out.println("Echo.echo('Hello') = " + echo.echo("Hello"));
   }

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="notes-and-warnings"><a class="anchor" href="#notes-and-warnings"></a>Notes and Warnings</h3>
<div class="paragraph">
<p>Finally, we use three visual styles to draw attention to information that might otherwise be overlooked.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">Note</div>
<div class="paragraph">
<p>A note is a tip or shortcut or alternative approach to the task at hand.
Ignoring a note should have no negative consequences, but you might miss out on a trick that makes your life easier.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="title">Important</div>
<div class="paragraph">
<p>Important boxes detail things that are easily missed: configuration changes that only apply to the current session, or services that need restarting before an update will apply.
Ignoring Important boxes won&#8217;t cause data loss but may cause irritation and frustration.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="title">Warning</div>
<div class="paragraph">
<p>A Warning should not be ignored.
Ignoring warnings will most likely cause data loss.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="provide-feedback-to-the-authors"><a class="anchor" href="#provide-feedback-to-the-authors"></a>Provide feedback to the authors!</h2>
<div class="sectionbody">
<div class="paragraph">
<p></p>
</div>
<div class="paragraph">
<p>If you find a typographical error in this manual, or if you have thought of a way to make this manual better, we would love to hear from you! Please submit a report in the the {this-issue.tracker.ur}, against the product Restcomm jDiameter`   `, or contact the authors.</p>
</div>
<div class="paragraph">
<p>When submitting a bug report, be sure to mention the manual&#8217;s identifier: Restcomm jDiameter</p>
</div>
<div class="paragraph">
<p>If you have a suggestion for improving the documentation, try to be as specific as possible when describing it.
If you have found an error, please include the section number and some of the surrounding text so we can find it easily.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction"><a class="anchor" href="#_introduction"></a>1. Introduction to Restcomm  JAIN SLEE</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JAIN SLEE is the specification for a Java Service Logic and Execution Environment (SLEE) architecture, created in the Java Community Process (JCP) by several individuals and companies, including Red Hat.
A SLEE is an application server, or service container, which defines a component model for structuring the logic of communications services as a collection of reusable components, and for combining these components into even more sophisticated services.
This model was designed and optimized for event-driven applications.</p>
</div>
<div class="paragraph">
<p>In addition to the service component model, the SLEE also defines management interfaces used to administer the container and the service components executing within, and a set of standard facilities, which provide common features, such as timers, traces and alarms, to JAIN SLEE components.</p>
</div>
<div class="paragraph">
<p>Restcomm JAIN SLEE is the first and only open source platform certified for JAIN SLEE 1.1 compliance, providing a highly scalable, event-driven application server with a robust component model and a fault tolerant execution environment.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/introduction-slee_and_jee.png" alt="introduction slee and jee">
</div>
<div class="title">Figure 1. Overview of JAIN SLEE</div>
</div>
<div class="paragraph">
<p>Restcomm  is built on top of the open source award winning JBoss Application Server , which means that Restcomm   complements  with Java Enterprise () 5 container features, allowing strong convergence of different application models, for even feature richer communication services, for instance, the Web and  can be combined to achieve a more sophisticated and natural user experience. Restcomm   inherits quality management features and tools from JBoss Application Server , such as the JMX Console, Jopr Plugins and SNMP Adaptor.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/introduction-platform.png" alt="introduction platform">
</div>
<div class="title">Figure 2. Restcomm  Platform</div>
</div>
<div class="paragraph">
<p>Restcomm JAIN SLEE can also be complemented with Restcomm SIP Servlets and Restcomm  Media Server, providing unique value and integration features not found elsewhere.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install"><a class="anchor" href="#_install"></a>2. Installing Restcomm  JAIN SLEE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_preinstall_requirements_and_prerequisites"><a class="anchor" href="#_preinstall_requirements_and_prerequisites"></a>2.1. Pre-Install Requirements and Prerequisites</h3>
<div class="paragraph">
<p>Ensure that the following requirements have been met before continuing with the install.</p>
</div>
<div class="sect3">
<h4 id="hardware-requirements"><a class="anchor" href="#hardware-requirements"></a>2.1.1. Hardware Requirements</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">Sufficient Disk Space</dt>
<dd>
<p>Once unzipped, the Restcomm JAIN SLEE binary release requires <em>at least</em> 500MB of free disk space.
Keep in mind that disk space requirements may change from release to release.</p>
</dd>
<dt class="hdlist1">Anything Java Itself Will Run On</dt>
<dd>
<p>The Restcomm JAIN SLEE container, and bundled JAIN SLEE components are 100% java.
The JAIN SLEE will run on the same hardware that the JBoss Application Server runs on, but it is recommended at least 2GB or 4GB of RAM memory, for 32 or 64 bit Operating Systems.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="software-prerequisites"><a class="anchor" href="#software-prerequisites"></a>2.1.2. Software Prerequisites</h4>
<div class="dlist">
<dl>
<dt class="hdlist1">JDK 6</dt>
<dd>
<p>A working installation of the Java Development Kit () version 6 is required in order to run the Restcomm  JAIN SLEE.
Note that the JBoss Application Server  is a runtime dependency, but comes bundled with the binary distribution.
For instructions on how to install the JDK, refer to <a href="#_jdk_installing_configuring_and_running">Java Development Kit (): Installing, Configuring and Running</a></p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="install-alternatives"><a class="anchor" href="#install-alternatives"></a>2.2. Install Alternatives</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">Binary Release</dt>
<dd>
<p>The binary release is a zip file containing an already built binary release of Restcomm JAIN SLEE</p>
</dd>
<dt class="hdlist1">Release Source Building</dt>
<dd>
<p>As an alternative to the binary release, it is possible to download a specific release source code and build a binary from it.</p>
</dd>
<dt class="hdlist1">Master Source Building</dt>
<dd>
<p>Similar as the Release Source Building, but done on the master (current development) source code.</p>
</dd>
<dt class="hdlist1">Binary Release Snapshot</dt>
<dd>
<p>The binary release snapshot is a build of the master source code done daily and upoaded to a public web site.</p>
</dd>
</dl>
</div>
<div class="sect3">
<h4 id="binary-release"><a class="anchor" href="#binary-release"></a>2.2.1. Binary Release</h4>
<div class="paragraph">
<p>You can download the Binary zip files from <a href="https://mobicents.ci.cloudbees.com/job/Restcomm-JAIN-SLEE-Release/lastSuccessfulBuild/artifact/release/" class="bare">https://mobicents.ci.cloudbees.com/job/Restcomm-JAIN-SLEE-Release/lastSuccessfulBuild/artifact/release/</a>.</p>
</div>
<div class="paragraph">
<p>In this form of installation, simply unzip the downloaded zip file to the directory of your choice on any operating system that supports the zip format.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Unzip the release file</p>
<div class="paragraph">
<p>Unzip the file to extract the archive contents into the location of your choice.
You can do this using the JDK jar tool (or any other ZIP extraction tool). In the example below we are assuming you downloaded the zip file was named restcomm-jainslee-2.8.0-SNAPSHOT .zip to the /restcomm directory.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>				    [usr]$ cd /restcomm
				    [usr]$ jar -xvf restcomm-jainslee.zip</code></pre>
</div>
</div>
</li>
<li>
<p>Setting up JBOSS_HOME Environment Variable</p>
<div class="paragraph">
<p>You should now have a directory called restcomm-jainslee-2.8.0-SNAPSHOT .
Next you need to set your JBOSS_HOME environment variables.
This is discussed in <a href="#_jboss_home_setup">Setting the JBOSS_HOME Environment Variable</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="binary-release-snapshot"><a class="anchor" href="#binary-release-snapshot"></a>2.2.2. Binary Release Snapshot</h4>
<div class="paragraph">
<p>You can download the Binary Snapshot zip files from <a href="https://github.com/RestComm/jain-slee/releases/latest" class="bare">https://github.com/RestComm/jain-slee/releases/latest</a>.
The installation is similar to the <a href="#_binary_release">[_binary_release]</a> one.</p>
</div>
</div>
<div class="sect3">
<h4 id="release-source-building"><a class="anchor" href="#release-source-building"></a>2.2.3. Release Source Building</h4>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Downloading the source code</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Git is used to manage Restcomm JAIN SLEE source code.
Instructions for downloading, installing and using Git can be found at <a href="http://git-scm.com/" class="bare">http://git-scm.com/</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use Git to checkout the specific release source, the Git repository URL is <a href="https://github.com/RestComm/jain-slee/" class="bare">https://github.com/RestComm/jain-slee/</a> , then switch to the specific release version, lets consider 2.8.0-SNAPSHOT .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>[usr]$ git clone https://github.com/RestComm/jain-slee restcomm-jain-slee-release
[usr]$ cd restcomm-jain-slee-release
[usr]$ git checkout tags/
[usr]$ cd release</code></pre>
</div>
</div>
</li>
<li>
<p>Building the source code</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Apache Ant 1.6 (or higher) and Maven 2.0.9 (or higher) is used to build the release.
Instructions for using Ant and Maven2, including install, can be found at <a href="http://ant.apache.org" class="bare">http://ant.apache.org</a> and <a href="http://maven.apache.org" class="bare">http://maven.apache.org</a>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Use Ant to build the binary.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>				    [usr]$ ant</code></pre>
</div>
</div>
<div class="paragraph">
<p>Once the process finishes you should have a restcomm-jainslee-2.8.0-SNAPSHOT.zip file, installation is the same as for <a href="#_binary_release">[_binary_release]</a>.</p>
</div>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_2x_branch_source_building"><a class="anchor" href="#_2x_branch_source_building"></a>2.2.4. 2.x Branch Source Building</h4>
<div class="paragraph">
<p>Similar process as for <a href="#_release_source_building">[_release_source_building]</a>, the only change is the Git reference should be the <code>2.x</code>.
The <code>git checkout tags/2.8.0-SNAPSHOT</code> command should not be performed.
If already performed, the following should be used in order to switch back to the 2.x branch:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>		    [usr]$ git checkout 2.x</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="master-source-building"><a class="anchor" href="#master-source-building"></a>2.2.5. Master Source Building</h4>
<div class="paragraph">
<p>Similar process as for <a href="#_release_source_building">[_release_source_building]</a>, the only change is the Git reference should be the <code>master</code>.
The <code>git checkout tags/2.8.0-SNAPSHOT</code> command should not be performed.
If already performed, the following should be used in order to switch back to the master:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code>		    [usr]$ git checkout master</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_uninstall"><a class="anchor" href="#_uninstall"></a>2.3. Uninstall Restcomm  JAIN SLEE</h3>
<div class="paragraph">
<p>To uninstall simply delete the directory containing Restcomm JAIN SLEE.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_and_running"><a class="anchor" href="#_configuration_and_running"></a>3. Configuring and Running Restcomm  JAIN SLEE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_server_profiles"><a class="anchor" href="#_server_profiles"></a>3.1. Server Profiles</h3>
<div class="paragraph">
<p>Restcomm JAIN SLEE reuses &amp;JEE.PLATFORM;server profiles to expose different configurations for different needs:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Default Profile</dt>
<dd>
<p>The <code class="app">default</code> profile is proper for standalone or pure high availability.
It provides the best performance per cluster node, with linear scaling, but there is no state replication in the cluster, which means that there is no support for failover, neither there is any kind of state gravitation (one node sending state so another node continues its work.</p>
</dd>
<dt class="hdlist1">All Profile</dt>
<dd>
<p>The <code class="app">all</code> profile is proper for more flexible high availability and failover support.
Performance per node decreases but the cluster does state replication or gravitation.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Profiles can be selected when starting the server, see <a href="#_running">Running Restcomm  JAIN SLEE</a> for detailed instructions.</p>
</div>
</div>
<div class="sect2">
<h3 id="_running"><a class="anchor" href="#_running"></a>3.2. Running Restcomm  JAIN SLEE</h3>
<div class="paragraph">
<p>Starting or stopping Restcomm JAIN SLEE is no different than starting or stopping &amp;JEE.PLATFORM;</p>
</div>
<div class="sect3">
<h4 id="starting"><a class="anchor" href="#starting"></a>3.2.1. Starting</h4>
<div class="paragraph">
<p>Once installed, you can run server(s) by executing the run.sh (Unix) or run.bat (Microsoft Windows) startup scripts in the <em class="path">&lt;install_directory&gt;/bin</em> directory (on Unix or Windows).</p>
</div>
<div class="sect4">
<h5 id="_starting_paramaters"><a class="anchor" href="#_starting_paramaters"></a>Starting Parameters</h5>
<div class="dlist">
<dl>
<dt class="hdlist1">Server Profile</dt>
<dd>
<p>To specify the server profile use <code>-c profile_name</code>, for instance, to use the <code class="app">all</code> profile then start the server with <code>-c all</code></p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If not specified the default profile is used.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">IP / Host</dt>
<dd>
<p>To specify the IP/Host which the server binds, use <code>-b IP</code>, for instance, to use the 192.168.0.1 IP then start the server with <code>-b 192.168.0.1</code></p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
If not specified then 127.0.0.1 is used.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="stopping"><a class="anchor" href="#stopping"></a>3.2.2. Stopping</h4>
<div class="paragraph">
<p>You can shut down the server(s) by executing the <code>shutdown.sh -s</code> (Unix) or <code>shutdown.bat -s</code> (Microsoft Windows) scripts in the <em class="path">&lt;install_directory&gt;/bin</em> directory (on Unix or Windows). Note that if you properly stop the server, you will see the following three lines as the last output in the Unix terminal or Command Prompt:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[Server] Shutdown complete
Shutdown complete
Halting VM</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_configuration"><a class="anchor" href="#_configuration"></a>3.3. Configuring Restcomm  JAIN SLEE</h3>
<div class="paragraph">
<p>JAIN SLEE is configured through an XML descriptor for each <a href="#_server_profiles">Server Profiles</a>.
The XML file is named <em class="path">jboss-beans.xml</em> and is located at <em class="path">$JBOSS_HOME/server/profile_name/deploy/restcomm-slee/META-INF</em>, where <code class="app">profile_name</code> is the server profile name.</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This configuration greatly affects performance or correctness of the container behavior.
This is for advanced users that know the internals of the container.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="eventcontext-factory-configuration"><a class="anchor" href="#eventcontext-factory-configuration"></a>3.4. EventContext Factory Configuration</h3>
<div class="paragraph">
<p>The EventContext Factory is responsible for managing all EventContexts in the SLEE Container, and its behavior is configurable.</p>
</div>
<div class="paragraph">
<p>The EventContext Factory configuration can be changed through an XML file and a JMX MBean.</p>
</div>
<div class="sect3">
<h4 id="eventcontext-factory-persistent-configuration"><a class="anchor" href="#eventcontext-factory-persistent-configuration"></a>3.4.1. EventContext Factory Persistent Configuration</h4>
<div class="paragraph">
<p>Configuration is done through an XML descriptor for each Restcomm Cluster.
The XML file is named <em class="path">jboss-beans.xml</em> and is located at <em class="path">{JBOSS_HOME}/server/{profile_name}/deploy/restcomm-slee/META-INF</em></p>
</div>
<div class="paragraph">
<p>The configuration is exposed a JBoss Microcontainer Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.EventContextFactoryConfiguration"
	class="org.mobicents.slee.container.management.jmx.EventContextFactoryConfiguration"&gt;
	&lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=
		"org.mobicents.slee:name=EventContextFactoryConfiguration",exposedInterface=
		org.mobicents.slee.container.management.jmx.EventContextFactoryConfigurationMBean.class,
		registerDirectly=true)&lt;/annotation&gt;
	&lt;property name="defaultEventContextSuspensionTimeout"&gt;60000&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. EventContext Factory Bean Configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defaultEventContextSuspensionTimeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines the default timeout applied when suspending delivery of an EventContext</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="eventcontext-factory-jmx-configuration"><a class="anchor" href="#eventcontext-factory-jmx-configuration"></a>3.4.2. EventContext Factory JMX Configuration</h4>
<div class="paragraph">
<p>Through JMX the EventContext Factory module configuration can be changed with the container running.
Note that such configuration changes are not persisted.</p>
</div>
<div class="paragraph">
<p>The JMX MBean which can be used to change the EventContext Factory configuration is named <code class="app">org.mobicents.slee:name=EventContextFactoryConfiguration</code>, and provides getters and setters to change each property defined in the persistent configuration.
The JMX Console can be used to use this MBean, see <a href="#_management_jmx_console">JMX Console</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_event_router_configuration"><a class="anchor" href="#_event_router_configuration"></a>3.5. Event Router Statistics and Configuration</h3>
<div class="paragraph">
<p>The JAIN SLEE Event Router is the module responsible for creating new service instances and delivering events to all interested parties.
It is capable of doing the routing of several events in parallel, through the usage of multiple executors, each bound to a different thread.</p>
</div>
<div class="paragraph">
<p>The Event Router is also able to account performance and load statistics, indicating the number of activities being assigned or several timings regarding event routing, globally or for each individual executor/thread.
Statistics are turned on by default and may be retrieved through the JMX MBean <code class="app">org.mobicents.slee:name=EventRouterStatistics</code>.</p>
</div>
<div class="paragraph">
<p>An important sub-module of the Event Router is the Executor Mapper, which is responsible for assigning activities to the available executors.
JAIN SLEE includes two different Executor Mappers.
The default one takes into account the hashcode of the activity handle when distributing, while the alternative uses a round robin algorithm.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the case of advanced performance tuning, it is advised to try the different implementations available, or even provide a custom one.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The Executor Mapper is nothing more than an interface: <code class="class">org.mobicents.slee.container.eventrouter.EventRouterExecutorMapper</code>.
To deploy a custom implementation, drop the implementation class or classes, packed in a jar file, in the server profile <em class="path">/deploy</em> directory.</p>
</div>
<div class="paragraph">
<p>The whole Event Router is a critical component with respect to the container&#8217;s performance.
Its configuration can be tuned, through an XML file and a JMX MBean.</p>
</div>
<div class="sect3">
<h4 id="event-router-persistent-configuration"><a class="anchor" href="#event-router-persistent-configuration"></a>3.5.1. Event Router Persistent Configuration</h4>
<div class="paragraph">
<p>Configuration is done through an XML descriptor for each <a href="#_server_profiles">Server Profiles</a>.
The XML file is named <em class="path">jboss-beans.xml</em> and is located at <em class="path">$JBOSS_HOME/server/profile_name/deploy/restcomm-slee/META-INF</em>, where <code class="app">profile_name</code> is the server profile name.</p>
</div>
<div class="paragraph">
<p>The configuration is exposed a JBoss Microcontainer Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.EventRouterConfiguration"
	class="org.mobicents.slee.container.management.jmx.EventRouterConfiguration"&gt;
	&lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=
		"org.mobicents.slee:name=EventRouterConfiguration",	exposedInterface=
		org.mobicents.slee.container.management.jmx.EventRouterConfigurationMBean.class,
		registerDirectly=true)&lt;/annotation&gt;
	&lt;property name="eventRouterThreads"&gt;8&lt;/property&gt;
	&lt;property name="collectStats"&gt;true&lt;/property&gt;
	&lt;property name="executorMapperClassName"&gt;
		org.mobicents.slee.runtime.eventrouter.mapping.ActivityHashingEventRouterExecutorMapper
	&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. JAIN SLEE Event Router Bean Configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">eventRouterThreads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines how many executors should be used by the Event Router, each bounds to a different thread</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">collectStats</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines if performance and load statistics should be collected, turning this feature off will increase performance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">confirmSbbEntityAttachement</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines if the event router should reconfirm that sbb entities are attached to activity context, before delivering event, this will avoid that a sbb entity handles concurrent events after it detachs, turning this feature off will increase performance</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">executorMapperClassName</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This property defines the implementation class of Executor Mapper used by the Event Router, the one above and default uses the activity handle hashcode to do the mapping, an alternative is org.mobicents.slee.runtime.eventrouter .mapping.RoundRobinEvent RouterExecutorMapper, which uses Round Robin algorithm.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="event-router-jmx-configuration"><a class="anchor" href="#event-router-jmx-configuration"></a>3.5.2. Event Router JMX Configuration</h4>
<div class="paragraph">
<p>Through JMX, the Event Router module configuration can be changed while the container is running.
These configuration changes are not persisted.</p>
</div>
<div class="paragraph">
<p>The JMX MBean that can be used to change the Event Router configuration is named <code class="app">org.mobicents.slee:name=EventRouterConfiguration</code>, and provides getters and setters to change each property defined in the persistent configuration.
See <a href="#_management_jmx_console">JMX Console</a> for how the JMX Console can be used to use this MBean.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="timer-facility-configuration"><a class="anchor" href="#timer-facility-configuration"></a>3.6. Timer Facility Configuration</h3>
<div class="paragraph">
<p>The JAIN SLEE Timer Facility is the module responsible for managing SLEE timers, and the number of threads it uses is configurable.</p>
</div>
<div class="paragraph">
<p>The Timer Facility configuration can be changed through an XML file and a JMX MBean.</p>
</div>
<div class="sect3">
<h4 id="timer-facility-persistent-configuration"><a class="anchor" href="#timer-facility-persistent-configuration"></a>3.6.1. Timer Facility Persistent Configuration</h4>
<div class="paragraph">
<p>Configuration is done through an XML descriptor for each Restcomm Cluster.
The XML file is named <em class="path">jboss-beans.xml</em> and is located at <em class="path">{JBOSS_HOME}/server/{profile_name}/deploy/restcomm-slee/META-INF</em></p>
</div>
<div class="paragraph">
<p>The configuration is exposed a JBoss Microcontainer Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.TimerFacilityConfiguration"
	class="org.mobicents.slee.container.management.jmx.TimerFacilityConfiguration"&gt;
	&lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=
		"org.mobicents.slee:name=TimerFacilityConfiguration",exposedInterface=
		org.mobicents.slee.container.management.jmx.TimerFacilityConfigurationMBean.class,
		registerDirectly=true)&lt;/annotation&gt;
	&lt;property name="timerThreads"&gt;4&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 3. JAIN SLEE Timer Facility Bean Configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timerThreads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines how many threads should be used by the Timer Facility</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">purgePeriod</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">defines the period (in minutes) of purging canceled tasks from the Timer Facility. Use 0 for no purge at all.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="timer-facility-jmx-configuration"><a class="anchor" href="#timer-facility-jmx-configuration"></a>3.6.2. Timer Facility JMX Configuration</h4>
<div class="paragraph">
<p>Through JMX the Timer Facility module configuration can be changed with the container running.
Note that such configuration changes are not persisted.</p>
</div>
<div class="paragraph">
<p>The JMX MBean which can be used to change the Timer Facility configuration is named <code class="app">org.mobicents.slee:name=TimerFacilityConfiguration</code>, and provides getters and setters to change each property defined in the persistent configuration.
The JMX Console can be used to use this MBean, see <a href="#_management_jmx_console">JMX Console</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_profiles_configuration"><a class="anchor" href="#_profiles_configuration"></a>3.6.3. Configuring JAIN SLEE Profiles</h4>
<div class="paragraph">
<p>JAIN SLEE Profiles is a component used to store data, usually related with a user and/or service profile.
JAIN SLEE maps JAIN SLEE Profiles to a Java Persistence API () Datasource, through Hibernate.</p>
</div>
<div class="paragraph">
<p>There are two configurations for JAIN SLEE Profiles provided as JBoss Microcontainer Beans:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.Profiles.JPA.HSQLDBConfig"
	class="org.mobicents.slee.container.deployment.profile.jpa.Configuration"&gt;
	&lt;property name="persistProfiles"&gt;true&lt;/property&gt;
	&lt;property name="clusteredProfiles"&gt;false&lt;/property&gt;
	&lt;property name="hibernateDatasource"&gt;java:/DefaultDS&lt;/property&gt;
	&lt;property name="hibernateDialect"&gt;org.hibernate.dialect.HSQLDialect&lt;/property&gt;
	&lt;depends&gt;jboss.jca:service=DataSourceBinding,name=DefaultDS&lt;/depends&gt;
&lt;/bean&gt;
&lt;bean name="Mobicents.JAINSLEE.Profiles.JPA.PostgreSQLConfig"
	class="org.mobicents.slee.container.deployment.profile.jpa.Configuration"&gt;
	&lt;property name="persistProfiles"&gt;true&lt;/property&gt;
	&lt;property name="clusteredProfiles"&gt;true&lt;/property&gt;
	&lt;property name="hibernateDatasource"&gt;java:/PostgresDS&lt;/property&gt;
	&lt;property name="hibernateDialect"&gt;org.hibernate.dialect.PostgreSQLDialect&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Configurations can be changed, or new ones can be added.
For new ones, ensure that the name attribute of the bean element is unique.
</td>
</tr>
</table>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 4. JAIN SLEE Profiles Bean Configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">persistProfiles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, profile changes are persisted into the data source.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clusteredProfiles</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true, then the container is aware there is a shared data source and that updates may be done by other nodes (for example, deletion of a JAIN SLEE profile table).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hibernateDatasource</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the Java Datasource deployed in the JBoss Application Server.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hibernateDialect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The java class name of the hibernate dialect to use, related with the selected datasource.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To switch the active configuration simply change the parameter injected in the bean named <code class="app">Mobicents.JAINSLEE.Container</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="other-configurations"><a class="anchor" href="#other-configurations"></a>3.6.4. Other Configurations</h4>
<div class="paragraph">
<p>Other JAIN SLEE runtime configuration is done through the following JBoss Microcontainer Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.MobicentsManagement"
	class="org.mobicents.slee.container.management.jmx.MobicentsManagement"&gt;
	&lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(
		name="org.mobicents.slee:service=MobicentsManagement",
		exposedInterface=org.mobicents.slee.container.management.
		jmx.MobicentsManagementMBean.class,
		registerDirectly=true)&lt;/annotation&gt;
	&lt;property name="entitiesRemovalDelay"&gt;1&lt;/property&gt;
	&lt;property name="timerThreads"&gt;8&lt;/property&gt;
	&lt;property name="loadClassesFirstFromAS"&gt;true&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 5. Other JAIN SLEE Configurations</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">entitiesRemovalDelay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of minutes before the container forces the ending of SBB entities from a service being deactivated.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timerThreads</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The number of threads used by the timer facility.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>This configuration can be changed with the container running with JMX.
Note that such configuration changes are not persisted.</p>
</div>
<div class="paragraph">
<p>To change the configuraton, use the JMX MBean named <code class="app">org.mobicents.slee:service=MobicentsManagement</code>, which provides getters and setters to change each property defined in the persistent configuration that is configurable with the container running.
The JMX Console can be used to use this MBean, as described in <a href="#_management_jmx_console">JMX Console</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="logging-configuration"><a class="anchor" href="#logging-configuration"></a>3.6.5. Logging Configuration</h4>
<div class="paragraph">
<p>Logging configuration is documented in section <a href="#_global_logging_config">Simplified Global Log4j Configuration</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_congestion_control_configuration_"><a class="anchor" href="#_congestion_control_configuration_"></a>3.6.6. Congestion Control Configuration</h4>
<div class="paragraph">
<p>Congesture Control feature configuration is documented in section <a href="#_congestion_control_configuration">Congestion Control Configuration</a></p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_management"><a class="anchor" href="#_management"></a>4. Managing Restcomm  JAIN SLEE</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_management_jmx_agent"><a class="anchor" href="#_management_jmx_agent"></a>4.1. JAIN SLEE JMX Agent</h3>
<div class="paragraph">
<p>The JMX Agent exposes all MBeans running in the server, including the ones mandated by the JAIN SLEE 1.1 specification.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The operations done through the JMX Agent are not kept once the server is shutdown.
For instance, if a deployable unit is installed through JMX, and the server is shutdown, once the server is started again the deployable unit will not be installed.
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
By default, the JMX Agent listens to port 1099, and is only available at the host/ip which the server is bound.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_management_snmp_agent"><a class="anchor" href="#_management_snmp_agent"></a>4.2. SNMP Agent</h3>
<div class="paragraph">
<p>JBoss Application Server provides an SNMP Agent, which can be used to &#8230;&#8203;</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
TODO
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_management_components"><a class="anchor" href="#_management_components"></a>4.3. Managing JAIN SLEE Components</h3>

</div>
<div class="sect2">
<h3 id="_management_persistent_file_deployer"><a class="anchor" href="#_management_persistent_file_deployer"></a>4.4. Persistent Deployable Unit Management</h3>
<div class="paragraph">
<p>JAIN SLEE provides a file deployer that greatly simplifies the management of JAIN SLEE deployable unit jars.
The deployer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Handles the installation of enclosed JAIN SLEE components.</p>
</li>
<li>
<p>Automatically activates and deactivates services contained.</p>
</li>
<li>
<p>Handles the creation, removal, activation, deactivation, link binding and link unbinding of all Resource Adapter Entities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All operations are persistent, which means that unlike management done through JMX, these survive server shutdowns.</p>
</div>
<div class="sect3">
<h4 id="_management_persistent_du_install"><a class="anchor" href="#_management_persistent_du_install"></a>4.4.1. Persistent Deployable Unit Install</h4>
<div class="paragraph">
<p>To install a deployable unit jar simply copy the file to <em class="path">$JBOSS_HOME/server/profile_name/deploy/</em>, where <code class="app">profile_name</code> is the server profile name.
Child directories can be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_management_persistent_du_uninstall"><a class="anchor" href="#_management_persistent_du_uninstall"></a>4.4.2. Persistent Deployable Unit Uninstall</h4>
<div class="paragraph">
<p>To uninstall a deployable unit jar simply delete the file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_management_persistent_deployer_additional_behavior"><a class="anchor" href="#_management_persistent_deployer_additional_behavior"></a>4.4.3. Beyond Deployable Unit (Un)Install</h4>
<div class="paragraph">
<p>The file deployer provides additional behavior then simply (un)install deployable unit jars, as done through the JAIN SLEE 1.1 DeploymentMBean:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Service (De)Activation</dt>
<dd>
<p>All services contained in the deployable unit jar are activated after the install, and deactivated prior to uninstall.
On service activation, if there is an active service in the SLEE, with same service name and vendor, then it is considered an older version, and the SLEE deactivates it. The deactivation of the old, and activation of the new, is done smoothly in a single operation, allowing service upgrades with no down time.</p>
</dd>
<dt class="hdlist1">Dependencies Management</dt>
<dd>
<p>The deployer puts the installation process on hold until all of the component&#8217;s dependencies are installed and activated.
When uninstalling, it waits for all of the components which depend on components inside the deployable unit to be uninstalled.
After an install or uninstall, the deployer evaluates all operations on hold.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_management_persistent_deployer_deploy_config_extension"><a class="anchor" href="#_management_persistent_deployer_deploy_config_extension"></a>4.4.4. Deploy-Config Extension</h4>
<div class="paragraph">
<p>A deployable unit jar may include a deploy-config.xml file in its <em class="path">META-INF/</em> directory.
This file provides additional management actions for persistent install/uninstall operations:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Resource Adaptor Entity Management</dt>
<dd>
<p>It is possible to specify RA entities, and the container will create and activate the RA entities after the deployable unit is installed.
During the uninstall process, the container will deactivate and remove those RA entities.</p>
</dd>
<dt class="hdlist1">Resource Adaptor Links Management</dt>
<dd>
<p>It is possible to specify RA links, and the container will bind those after the deployable unit is installed.
When uninstalled, the container will unbind those RA links as well.
The links are set for resource adapter entities created in the <em class="path">deploy-config.xml</em> file.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This file should comply with the following schema:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;

&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"&gt;
  &lt;xs:element name="deploy-config"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="ra-entity" maxOccurs="unbounded" minOccurs="0"/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name="property"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name="name" type="xs:string" use="required" /&gt;
      &lt;xs:attribute name="type" type="xs:string" use="required" /&gt;
      &lt;xs:attribute name="value" type="xs:string" use="required" /&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name="properties"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="property" maxOccurs="unbounded" minOccurs="0"/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name="file" type="xs:string" use="optional" /&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name="ra-entity"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="properties" maxOccurs="1" minOccurs="0"/&gt;
        &lt;xs:element ref="ra-link" maxOccurs="unbounded" minOccurs="0"/&gt;
      &lt;/xs:sequence&gt;
      &lt;xs:attribute name="resource-adaptor-id" type="xs:string" use="required" /&gt;
      &lt;xs:attribute name="entity-name" type="xs:string" use="required" /&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

  &lt;xs:element name="ra-link"&gt;
    &lt;xs:complexType&gt;
      &lt;xs:attribute name="name" type="xs:string" use="required" /&gt;
    &lt;/xs:complexType&gt;
  &lt;/xs:element&gt;

&lt;/xs:schema&gt;</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;ra-entity
	resource-adaptor-id="ResourceAdaptorID[name=JainSipResourceAdaptor,vendor=net.java.slee.sip,version=1.2]"
	entity-name="SipRA"&gt;
	&lt;properties&gt;
		&lt;property name="javax.sip.PORT" type="java.lang.Integer" value="5060" /&gt;
	&lt;/properties&gt;
	&lt;ra-link name="SipRA" /&gt;
&lt;/ra-entity&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The deploy-config.xml example above defines a resource adaptor entity named <code>SipRa</code>, to be created for the resource adaptor with id <code>ResourceAdaptorID[name=JainSipResourceAdaptor, vendor=net.java.slee.sip, version=1.2]</code>, and with a single config property named <code>javax.sip.PORT</code> of type <code>java.lang.Integer</code> and with value <code>5060</code>.
Additionally, a resource adaptor link named <code>SipRa</code> should be bound to the resource adaptor entity.</p>
</div>
<div class="paragraph">
<p>After the deployable unit is installed, the resource adaptor entity is created, activated and the resource adaptor link is bound.
Before the deployable unit is uninstalled, or the server is shutdown, the link is unbound, then the resource adaptor entity is deactivated, and finally the same resource adaptor entity is removed.</p>
</div>
<div class="paragraph">
<p>The SLEE includes a deploy-config.xml file at <em class="path">$JBOSS_HOME/server/profile_name/deploy/restcomm-slee</em>, where <code class="app">profile_name</code> is the server profile name, and that file can be used to specify RA entities and links too.
If an RA is installed using the persistent deployer, then SLEE reads its own deploy-config.xml file, and if there are RA entities and/or links specified with same RA ID, then the operations to create/activate/deactivate/remove these are executed too, as if these were specified in the Deployable Unit&#8217;s own deploy-config.xml.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_management_tools_ant_tasks"><a class="anchor" href="#_management_tools_ant_tasks"></a>4.5. Ant Tasks</h3>
<div class="paragraph">
<p>JAIN SLEE includes some tasks for Apache Ant, which can be used for common management tasks done through , when the container is running.
The tasks come bundled in <em class="path">$JBOSS_HOME/server/default/deploy/restcomm-slee/lib/ant-tasks.jar</em>.
To use these, the Ant script must include the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;property environment="system" /&gt;
&lt;property name="node" value="default" /&gt;
&lt;property name="jboss.deploy" value="${system.JBOSS_HOME}/server/${node}/deploy" /&gt;

&lt;path id="project.classpath"&gt;
	&lt;fileset dir="${jboss.deploy}/restcomm-slee/lib"&gt;
		&lt;include name="*.jar" /&gt;
	&lt;/fileset&gt;
	&lt;fileset dir="${system.JBOSS_HOME}/client"&gt;
		&lt;include name="*.jar" /&gt;
	&lt;/fileset&gt;
&lt;/path&gt;

&lt;property name="project.classpath" refid="project.classpath" /&gt;

&lt;property name="jnpHost" value="127.0.0.1" /&gt;
&lt;property name="jnpPort" value="1099" /&gt;

&lt;taskdef name="slee-management"
	classname="org.mobicents.ant.MobicentsManagementAntTask"
	classpath="${project.classpath}" /&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is important to understand some properties set by the code above:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code class="parameter">node</code></dt>
<dd>
<p>This property defines the server configuration profile to be used, for further information about those refer to <a href="#_server_profiles">Server Profiles</a>.</p>
</dd>
<dt class="hdlist1"><code class="parameter">jnpHost</code></dt>
<dd>
<p>The host/ip which Restcomm JAIN SLEE is bound.</p>
</dd>
<dt class="hdlist1"><code class="parameter">jnpPort</code></dt>
<dd>
<p>The port which the JMX Agent is listening.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
The property values can be overridden when invoking the Ant script.
To do this, use the parameter <code class="parameter">-DpropertyName=propertyValue</code>.
For example, the server profile can be changed from <code class="app">default</code> to <code class="app">all</code> using <code class="parameter">-Dnode=all</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_management_tools_ant_tasks_slee_management"><a class="anchor" href="#_management_tools_ant_tasks_slee_management"></a>4.5.1. SLEE Management Task</h4>
<div class="paragraph">
<p>The <code>slee-management</code> task allows a script to manage JAIN SLEE deployable units, services and resource adapters.
The operations, or sub-tasks, are done through .</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management jnpport="${jnpPort}" host="${jnpHost}"&gt;
	&lt;!-- sub-tasks --&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The attributes have the same meaning as the properties listed in the script code to import the tasks here: <a href="#_management_tools_ant_tasks">Ant Tasks</a>.</p>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_install_du"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_install_du"></a>Install Deployable Unit Sub-Task</h5>
<div class="paragraph">
<p>The <code>install</code> sub-task installs JAIN SLEE the deployable unit jar pointed by the value of attribute <code class="parameter">url</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management jnpport="${jnpPort}" host="${jnpHost}"&gt;
	&lt;install url="file:///tmp/my-deployable-unit.jar" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_uninstall_du"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_uninstall_du"></a>Uninstall Deployable Unit Sub-Task</h5>
<div class="paragraph">
<p>The <code>uninstall</code> sub-task uninstalls JAIN SLEE the deployable unit jar which was installed from the value of attribute <code class="parameter">url</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management jnpport="${jnpPort}" host="${jnpHost}"&gt;
	&lt;uninstall url="file:///tmp/my-deployable-unit.jar" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_activate_service"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_activate_service"></a>Activate Service Sub-Task</h5>
<div class="paragraph">
<p>The <code>activateservice</code> sub-task activates an already installed JAIN SLEE service, with the id specified by the value of attribute <code class="parameter">componentid</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;activateservice
		componentid="ServiceID[name=FooService,vendor=org.mobicents,version=1.0]" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_deactivate_service"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_deactivate_service"></a>Deactivate Service Sub-Task</h5>
<div class="paragraph">
<p>The <code>deactivateservice</code> sub-task deactivates an already installed JAIN SLEE service, with the id specified by the value of attribute <code class="parameter">componentid</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;deactivateservice
		componentid="ServiceID[name=FooService,vendor=org.mobicents,version=1.0]" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_create_ra_entity"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_create_ra_entity"></a>Create Resource Adaptor Entity Sub-Task</h5>
<div class="paragraph">
<p>The <code>createraentity</code> sub-task creates the resource adaptor entity with the name specified by the value of attribute <code class="parameter">entityname</code>, for an already installed JAIN SLEE resource adaptor, with the id specified by the value of attribute <code class="parameter">componentid</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;createraentity
		componentid="ResourceAdaptorID[name=FooRA,vendor=org.mobicents,version=1.0]"
		entityname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_remove_ra_entity"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_remove_ra_entity"></a>Remove Resource Adaptor Entity Sub-Task</h5>
<div class="paragraph">
<p>The <code>removeraentity</code> sub-task removes the resource adaptor entity with the name specified by the value of attribute <code class="parameter">entityname</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;removeraentity entityname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_activate_ra_entity"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_activate_ra_entity"></a>Activate Resource Adaptor Entity Sub-Task</h5>
<div class="paragraph">
<p>The <code>activateraentity</code> sub-task activates the resource adaptor entity with the name specified by the value of attribute <code class="parameter">entityname</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;activateraentity entityname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_deactivate_ra_entity"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_deactivate_ra_entity"></a>Deactivate Resource Adaptor Entity Sub-Task</h5>
<div class="paragraph">
<p>The <code>deactivateraentity</code> sub-task deactivates the resource adaptor entity with the name specified by the value of attribute <code class="parameter">entityname</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;deactivateraentity entityname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_bind_ra_link"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_bind_ra_link"></a>Bind Resource Adaptor Link Sub-Task</h5>
<div class="paragraph">
<p>The <code>bindralinkname</code> sub-task binds the resource adaptor link with the name specified by the value of attribute <code class="parameter">linkname</code>, for an already active JAIN SLEE resource adaptor entity, with the name specified by the value of attribute <code class="parameter">entityname</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;bindralinkname entityname="FooRA"
		linkname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_management_tools_ant_tasks_slee_management_unbind_ra_link"><a class="anchor" href="#_management_tools_ant_tasks_slee_management_unbind_ra_link"></a>Unbind Resource Adaptor Link Sub-Task</h5>
<div class="paragraph">
<p>The <code>unbindralinkname</code> sub-task unbinds the resource adaptor link with the name specified by the value of attribute <code class="parameter">linkname</code>.
Example of usage:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;slee-management host="${jnpHost}" jnpport="${jnpPort}"&gt;
	&lt;unbindralinkname linkname="FooRA" /&gt;
&lt;/slee-management&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="management-consoles"><a class="anchor" href="#management-consoles"></a>4.6. Management Consoles</h3>
<div class="sect3">
<h4 id="_management_jmx_console"><a class="anchor" href="#_management_jmx_console"></a>4.6.1. JMX Console</h4>
<div class="paragraph">
<p>JBoss Application Server provides a simple web console that gives quick access to all MBeans registered in the server, which includes the ones defined by the JAIN SLEE 1.1 specification.</p>
</div>
<div class="paragraph">
<p>To access the JMX console once the server is running, point a web browser to <code><a href="http://ip:8080/jmx-console" class="bare">http://ip:8080/jmx-console</a></code>, where <code>ip</code> is the IP/Host the container is bound.
Unless set during start up, the IP/Host will be <code>127.0.0.1/localhost</code> by default.</p>
</div>
<div class="paragraph">
<p>MBeans in the domain <code>javax.slee</code> are all standard JAIN SLEE 1.1 MBeans, while the ones in the domain <code>org.mobicents.slee</code> are proprietary to Restcomm  JAIN SLEE.
The following ones are of particular interest:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>org.mobicents.slee:service=MobicentsManagement</code></dt>
<dd>
<p>the MBean which can be used to make non persistent changes to the server configuration, in runtime.
The operation <code>dumpContainerState</code> displays a textual snapshot of the server&#8217;s state, which can be used to quickly look for memory leaks or other debug/profiling related tasks.</p>
</dd>
<dt class="hdlist1"><code>org.mobicents.slee:name=DeployerMBean</code></dt>
<dd>
<p>the MBean allows interaction with the persistent deployable unit deployer.
The operation <code>showStatus</code> displays a textual snapshot of the deployers&#8217;s state, which can be used to quickly find out if there is any deployable unit deployment pending, for instance, due to missing dependencies.</p>
</dd>
<dt class="hdlist1"><code>org.mobicents.slee:name=CongestionControlConfiguration</code></dt>
<dd>
<p>the MBean allows changing or retrieving the Congestion Control feature, with the container running.
Details are provided in section <a href="#_congestion_control_configuration">Congestion Control Configuration</a>.</p>
</dd>
</dl>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
For further information about JAIN SLEE 1.1 MBeans and their operations refer to the JAIN SLEE 1.1 Specification, all are covered with great detail.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_management_web_console"><a class="anchor" href="#_management_web_console"></a>4.6.2. SLEE Management Console</h4>
<div class="paragraph">
<p>The JMX Console is simple but the MBeans operations were made considering its invocation by management clients, not people using browsers.
The SLEE Management Console is a web application that provides high level management functionality for the SLEE, and comes pre-deployed in SLEE binary releases.
To access this console point a web browser to <code><a href="http://ip:8080/slee-management-console" class="bare">http://ip:8080/slee-management-console</a></code>, where <code>ip</code> is the IP/Host the container is bound.
Unless set during start up, the IP/Host will be <code>127.0.0.1/localhost</code> by default.</p>
</div>
<div class="paragraph">
<p>Full documentation for this management tool can be found in <em class="path">docs/tools/slee-management-console</em> directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_management_jon_console"><a class="anchor" href="#_management_jon_console"></a>4.6.3. Jopr Console</h4>
<div class="paragraph">
<p>Joprwas developed to become Red Hat&#8217;s Middleware Administration Tool, providing an unified interface and extensible model, to be used mainly to control and monitor servers individually, or clusters.</p>
</div>
<div class="paragraph">
<p>Restcomm JAIN SLEE binary release includes a JoprConsole in <em class="path">tools/jopr-plugin</em>, with standalone documentation on same path, but inside <em class="path">docs</em> directory.</p>
</div>
</div>
<div class="sect3">
<h4 id="_management_twiddle_cli"><a class="anchor" href="#_management_twiddle_cli"></a>4.6.4. TWIDDLE CLI</h4>
<div class="paragraph">
<p>Both,  Console and  Jopr Console, are graphic(web) based tools.
Some deployments may require command line access to Restcomm  .
To aid such cases, Restcomm  offers <code>TWIDDLE</code> based CLI.
It allows to manage single instance (remote or local) of Restcomm   server.</p>
</div>
<div class="paragraph">
<p>Restcomm JAIN SLEE binary release includes a TWIDDLE CLI in <em class="path">tools/twiddle</em>, with standalone documentation on same path, but inside <em class="path">docs</em> directory.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="logging-traces-and-alarms"><a class="anchor" href="#logging-traces-and-alarms"></a>5. Logging, Traces and Alarms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_log4j_service"><a class="anchor" href="#_log4j_service"></a>5.1. Log4j Logging Service</h3>
<div class="paragraph">
<p>In Restcomm JAIN SLEE <code>Apache log4j</code> is used for logging.
If you are not familiar with the log4j package and would like to use it in your applications, you can read more about it at the <a href="http://jakarta.apache.org/log4j/">Jakarta web site</a>.</p>
</div>
<div class="paragraph">
<p>Logging is controlled from a central <em class="path">conf/jboss-log4j.xml</em> file, in each server configuration profile.
This file defines a set of appenders specifying the log files, what categories of messages should go there, the message format and the level of filtering.
By default, in Restcomm  produces output to both the console and a log file (<em class="path">log/server.log</em>).</p>
</div>
<div class="paragraph">
<p>There are 6 basic log levels used: TRACE, DEBUG, INFO, WARN, ERROR and FATAL.</p>
</div>
<div class="paragraph">
<p>Logging is organized in categories and appenders.
Appenders control destination of log entries.
Different appenders differ in configuration, however each supports threshold.
Threshold filters log entries based on their level.
Threshold set to WARN will allow log entry to pass into appender if its level is WARN, ERROR or FATAL, other entries will be discarded.
For more details on appender configuration please refer to its documentation or java doc.</p>
</div>
<div class="paragraph">
<p>The logging threshold on the console is INFO, by default.
In contrast, there is no threshold set for the server.log file, so all generated logging messages are  logged there.</p>
</div>
<div class="paragraph">
<p>Categories control level for loggers and its children, for details please refer to log4j manual.</p>
</div>
<div class="paragraph">
<p>By default  Restcomm JAIN SLEE inherits level of INFO from root logger.
To make platform add more detailed logs, file             <em class="path">conf/jboss-log4j.xml</em> has to be altered.
Explicit category definition for Restcomm  JAIN SLEE looks like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;category name="org.mobicents.slee"&gt;
    &lt;priority value="INFO"/&gt;
&lt;/category&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This limits the level of logging to INFO for all Restcomm JAIN SLEE classes.
It is possible to declare more categories with different level, to provide logs with greater detail.</p>
</div>
<div class="paragraph">
<p>For instance, to provide detailed information on Restcomm JAIN SLEE transaction engine in separate log file(<em class="path">txmanager.log</em>), file   <em class="path">conf/jboss-log4j.xml</em> should contain entries as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;appender name="TXMANAGER" class="org.jboss.logging.appender.RollingFileAppender"&gt;
    &lt;errorHandler class="org.jboss.logging.util.OnlyOnceErrorHandler"/&gt;
    &lt;param name="File" value="${jboss.server.home.dir}/log/txmanager.log"/&gt;
    &lt;param name="Append" value="false"/&gt;
    &lt;param name="MaxFileSize" value="500KB"/&gt;
    &lt;param name="MaxBackupIndex" value="1"/&gt;

    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
        &lt;param name="ConversionPattern" value="%d %-5p [%c] %m%n"/&gt;
    &lt;/layout&gt;
&lt;/appender&gt;

&lt;category name="org.mobicents.slee.runtime.transaction"&gt;
    &lt;priority value="DEBUG" /&gt;
    &lt;appender-ref ref="TXMANAGER"/&gt;
&lt;/category&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This creates a new file appender and specifies that it should be used by the logger (or category) for the package org.mobicents.slee.runtime.transaction.</p>
</div>
<div class="paragraph">
<p>The file appender is set up to produce a new log file every day rather than producing a new one every time you restart the server or writing to a single file indefinitely.
The current log file is txmanager.log.
Older files have the date they were written added to their filenames.</p>
</div>
<div class="sect3">
<h4 id="_global_logging_config"><a class="anchor" href="#_global_logging_config"></a>5.1.1. Simplified Global Log4j Configuration</h4>
<div class="paragraph">
<p>Besides manual logging configuration, described previously, Restcomm JAIN SLEE also exposes management operations that greatly simplify such configuration, allowing the administrator to select through predefined and complete logging configuration presets.
Such operations are available in MBean named <em class="path">org.mobicents.slee%3Aservice%3DMobicentsManagement</em>, and the available presets are:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Level</dt>
<dd>
<p>The available management operations are:</p>
<div class="ulist">
<ul>
<li>
<p>DEFAULT: Regular logging, at INFO level, displaying most user-related messages;</p>
</li>
<li>
<p>DEBUG: More verbose logging, mostly using DEBUG/TRACE level, displaying message of interest for developers;</p>
</li>
<li>
<p>PRODUCTION: Low verbosity and async logging, mostly in WARN level, for systems in production so that logging does impact performance.</p>
</li>
</ul>
</div>
</dd>
<dt class="hdlist1">JMX Operation</dt>
<dd>
<div class="ulist">
<ul>
<li>
<p>getLoggingConfiguration: retrieves what is the current logging configuration;</p>
</li>
<li>
<p>switchLoggingConfiguration: allows switching to a different configuration preset;</p>
</li>
<li>
<p>setLoggingConfiguration: used to upload a complete logging configuration.</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Custom presets can be easily deployed in the application server too.
Simply name the configuration file as <em class="path">jboss-log4j.xml.PRESET_NAME</em>, where <code>PRESET_NAME</code> should be unique preset name, and copy it to directory <em class="path">$JBOSS_HOME/server/profile_name/deploy/restcomm-slee/log4j-templates</em>, where <code class="app">profile_name</code> is the server profile name.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
These procedures changes the whole JBoss Application Server Platform logging configuration, so it will affect also logging for other running applications besides the JAIN SLEE container.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="alarm-facility"><a class="anchor" href="#alarm-facility"></a>5.2. Alarm Facility</h3>
<div class="paragraph">
<p>The <code>JAIN SLEE Alarm Facility</code> is used by SBBs, Resource Adaptors, and Profiles to request the SLEE to raise or clear alarms.
If a request is made to raise an alarm and the identified alarm has not already been raised, the alarm is raised and a corresponding alarm notification is generated by the <code>AlarmMBean</code>.
If a request is made to clear an alarm and the identified alarm is currently raised, the alarm is cleared and a corresponding alarm notification is generated by the <code>AlarmMBean</code>.</p>
</div>
<div class="paragraph">
<p>Alarm notifications are intended for consumption by management clients external to the SLEE.
The management client is responsible for registering to receive alarm notifications generated by the Alarm Facility through the external management interface of the <code>Alarm Facility</code>.
The management client may optionally provide notification filters so that only the alarm notifications that the management client would like to receive are transmitted to the management client.</p>
</div>
<div class="paragraph">
<p>For further information on how to use <code>JAIN SLEE Alarm Facility</code> and receive JMX notifications refer to the JAIN SLEE 1.1 Specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="trace-facility"><a class="anchor" href="#trace-facility"></a>5.3. Trace Facility</h3>
<div class="paragraph">
<p>Notification sources such as SBBs, Resource Adaptors, Profiles, and SLEE internal components can use the <code>Trace Facility</code> to generate trace messages intended for consumption by external management clients.
Management clients register to receive trace messages generated by the <code>Trace Facility</code> through the external management interface (MBean). Filters can be applied, in a similar way as in case of Alarms.</p>
</div>
<div class="paragraph">
<p>Within the SLEE, notification sources use a <code>tracer</code> to emit trace messages.
A tracer is a named entity.
Tracer names are case-sensitive and follow the Java hierarchical naming conventions.
A tracer is considered to be an ancestor of another tracer if its name followed by a dot is a prefix of the descendant tracer&#8217;s name.
A tracer is considered to be a parent of a tracer if there are no ancestors between itself and the descendant tracer.
For example, the tracer named <code>com</code> is the parent tracer of the tracer named <code>com.foo</code> and an ancestor of the tracer named <code>com.foo.bar</code>.</p>
</div>
<div class="paragraph">
<p>All tracers are implicitly associated with a notification source, which identifies the object in the SLEE that is emitting the trace message and is included in trace notifications generated by the <code>Trace MBean</code> on behalf of the tracer.
For instance, an SBB notification source is composed by the SBB id and the Service id.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Multiple notification sources may have tracers with same name in SLEE.
Comparing with common logging frameworks, this would mean that the notification source would be part of the log category or name.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For further information on how to use <code>JAIN SLEE Trace Facility</code> and receive JMX notifications refer to the JAIN SLEE 1.1 Specification.</p>
</div>
<div class="sect3">
<h4 id="_tracers_vs_log4j"><a class="anchor" href="#_tracers_vs_log4j"></a>5.3.1. JAIN SLEE Tracers and Log4j</h4>
<div class="paragraph">
<p>Restcomm JAIN SLEE Tracers additionally log messages to <code class="app">Apache Log4j</code>, being the log4j category, for notification source <code>X</code>, defined as <code>javax.slee.</code> concatenated with the <code>X.toString()</code>.</p>
</div>
<div class="paragraph">
<p>For instance, the full log4j logger <code>name</code> for tracer named <code>GoogleTalkBotSbb</code>, of sbb notification source with <code>SbbID[name=GoogleTalkBotSbb,vendor=restcomm,version=1.0]</code> and <code>ServiceID[name=GoogleTalkBotService,vendor=restcomm,version=1.0]</code>, would be <code>javax.slee.SbbNotification[service=ServiceID[name=GoogleTalkBotService, vendor=restcomm,version=0.1], sbb=SbbID[name=GoogleTalkBotSbb,vendor=restcomm, version=0.1]].GoogleTalkBotSbb</code> (without the spaces or breaks), which means a log4j category defining its level as <code>DEBUG</code> could be:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;category
	name="javax.slee.SbbNotification[service=ServiceID[name=GoogleTalkBotService,
	vendor=restcomm,version=0.1],sbb=SbbID[name=GoogleTalkBotSbb,
	vendor=restcomm,version=0.1]]"&gt;
    &lt;priority value="DEBUG" /&gt;
&lt;/category&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The relation of JAIN SLEE <code>tracers</code> and log4j <code>loggers</code> goes beyond log4j showing tracer&#8217;s messages, changing the tracer&#8217;s log4j logger <code>effective level</code> changes the tracer level in SLEE, and vice-versa.
Since JAIN SLEE tracer levels differ from log4j logger levels a mapping is needed:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 6. Mapping JAIN SLEE Tracer Levels with Apache Log4j Logger Levels</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Tracer Level</th>
<th class="tableblock halign-left valign-top">Logger Level</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SEVERE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARNING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FINE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FINER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEBUG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FINEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TRACE</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clustering"><a class="anchor" href="#_clustering"></a>6. Restcomm  JAIN SLEE Clustering</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JAIN SLEE supports clustering, whether it is simple high availability () or complete fault tolerance () support.
This is achieved through the replication of the container state.
The Restcomm  JAIN SLEE implementation also exposes a clustering extension  for Resource Adaptors components, which live outside the container.</p>
</div>
<div class="sect2">
<h3 id="_container_clustering"><a class="anchor" href="#_container_clustering"></a>6.1. High Availability and Fault Tolerance</h3>
<div class="paragraph">
<p>The used JAIN SLEE clustering mode is defined by the selected server profile:</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
JAIN SLEE reuses the JBoss Application Server clustering framework, and if all nodes of a cluster are in the same network then the underlying JBoss Application Server clustering will automatically handle the discovery of new cluster nodes and join these to the cluster.
For more complicated setups, refer to the JBoss Application Server clustering documentation.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_container_clustering_high_availability_profile"><a class="anchor" href="#_container_clustering_high_availability_profile"></a>6.1.1. High Availability Mode</h4>
<div class="paragraph">
<p>High availability mode provides no clustering functionality per say.
The mode is useful when deploying for example single node, non-replicated or hot-cold configurations.
In this mode all clustering needs to be explicitly done by the developer where applicable.
In this sense,  mode is not a clustered mode.</p>
</div>
<div class="paragraph">
<p>The <code>default</code> server profile is used to start the server in  mode.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_clustering_fault_tolerant_profile"><a class="anchor" href="#_container_clustering_fault_tolerant_profile"></a>6.1.2. Fault Tolerant Mode</h4>
<div class="paragraph">
<p>The fault tolerant mode is a fully clustered mode with state replication.
An FT cluster can be viewed as one virtual container that extend over all the JAIN SLEE nodes that are active in the cluster.
All activity context and Sbb entity data is replicated across the cluster nodes and is hence fully redundant.
Events are not failed over, due to performance constraints, which means that an event fired and not yet routed will be lost if its cluster node fails.</p>
</div>
<div class="paragraph">
<p>The <code>all</code> server profile is used to start the server in  mode.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_container_clustering_fault_tolerant"><a class="anchor" href="#_container_clustering_fault_tolerant"></a>6.2. Component Redundancy in Fault Tolerant Clusters</h3>
<div class="paragraph">
<p>The fault tolerant clustering mode provides clustering for most of the JAIN SLEE components.
JAIN SLEE components can be divided into internal and external components.
Internal components are logically contained by the JAIN SLEE container, and external components are at least partly outside the container.</p>
</div>
<div class="paragraph">
<p>For a concrete example of how the container behaves in  mode, see <a href="#_fault_tolerant_cluster_example">Fault Tolerant Clustering - A Concrete Example</a>.</p>
</div>
<div class="sect3">
<h4 id="_container_clustering_ft_internal_components"><a class="anchor" href="#_container_clustering_ft_internal_components"></a>6.2.1. Internal Component Redundancy</h4>
<div class="paragraph">
<p>Internal SLEE components are components that are completely inside the JAIN SLEE container.
This group of components include  entities, internal activities, events and timers.
With the exception of events, all internal components will be fully redundant in a  JAIN SLEE configuration.</p>
</div>
<div class="paragraph">
<p>SBB entities are fully replicated.  entities are always serialized and saved by the container, regardless of the clustering profile.
In an  environment the container will replicate this serialized state to other nodes in the cluster so that it can be retrieved if the node fails or if the  entity is processed in another node.
All  entities will hence be accessible by any node in the cluster at any given time.</p>
</div>
<div class="paragraph">
<p>Timers are fully replicated.
Timers created in a given node will be executed in that same node.
If the node leaves the cluster, all active timers from that node are recreated and run in another node.</p>
</div>
<div class="paragraph">
<p>Activity context interfaces (), as well as activity handles are fully replicated.
The s for all activities are replicated within a fault tolerant cluster.
However, the activity object is not replicated by default and needs to be handled by the resource adaptor that owns the activity in question if replication is required.
The activity objects for all internal activities, e.g.
null activities, profile table activities and service activities, are fully replicated.</p>
</div>
<div class="paragraph">
<p>Events are not replicated because of performance constraints.
Hence, all events fired in a node is routed only in that node.
However, if an event is fired in one node, and an  entity created in another node has attached to that , the  entity will be retrieved in the node that fired the event and the event will be delivered to it.
Hence, even though the event is fired in a single node, the effects will be cluster-wide.
Because the events are not replicated, any event currently being routed in a node that fails, will be lost.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_clustering_ft_external_components"><a class="anchor" href="#_container_clustering_ft_external_components"></a>6.2.2. External Component Redundancy</h4>
<div class="paragraph">
<p>External JAIN SLEE components are components that are on the border between the SLEE container and the outside environment.
This group of components include resource adaptors and external activities, neither of which are replicated by default.</p>
</div>
<div class="paragraph">
<p>The Resource adaptors may use the Fault Tolerant Resource Adaptor API extension of the JAIN SLEE 1.1 specification in order to be cluster-aware.
Refer to the <a href="#_clustering_fault_tolerant_ra_api">Fault Tolerant Resource Adaptor API</a> and <a href="#_container_clustering_ra_activity_replication">Resource Adaptor Activity Replication</a> sections for more information on how to achieve resource adaptor and activity object redundancy.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_container_clustering_components_management"><a class="anchor" href="#_container_clustering_components_management"></a>6.3. Managing Components in Restcomm  JAIN SLEE Cluster</h3>
<div class="paragraph">
<p>JAIN SLEE clustering does not require special components management.
Components can be deployed and undeployed in all cluster modes, including fault tolerant setups, and the cluster will handle the operation correctly.
However, there are certain behaviours in fault tolerance setups to be aware of:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Service Activation</code></dt>
<dd>
<p>JAIN SLEE Service started events are only fired on the first cluster node started.</p>
</dd>
<dt class="hdlist1"><code>Service Deactivation</code></dt>
<dd>
<p>Only the last node will force the removal of the service&#8217;s  entities.</p>
</dd>
<dt class="hdlist1"><code>Resource Adaptor Entity Deactivation</code></dt>
<dd>
<p>Only the last node will force the removal of all its activities.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_clustering_fault_tolerant_ra_api"><a class="anchor" href="#_clustering_fault_tolerant_ra_api"></a>7. Fault Tolerant Resource Adaptor API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>JAIN SLEE Resource Adaptors exist on the boundary between the container and the underlying protocol.
The specification contract requires the 		object to implement the <code>javax.slee.resource.ResourceAdaptor</code>		interface.
This interface defines callbacks, which SLEE uses to interact with the 		, including one to provide the <code>javax.slee.resource.ResourceAdaptorContext</code>		object.
The Resource Adaptor Context provides 		object facilities to interact with SLEE.</p>
</div>
<div class="paragraph">
<p>The JAIN SLEE 1.1 RA API is a major milestone, standardizing RA and JSLEE contract.
However, it misses an API for clustering, which is critical for a RA deployed in a clustered JAIN SLEE environment.
The JAIN SLEE 1.1 contract does not define any fault tolerant data source nor cluster state callbacks.</p>
</div>
<div class="paragraph">
<p>The <code class="app">Fault Tolerant RA API</code>	extends the JAIN SLEE 1.1 RA 	, providing missing features related to clustering.
An effort has been made keep the API similar to the standard RA contract, so that anyone who has developed a JAIN SLEE 1.1 RA is able to easily use the proprietary API extension.</p>
</div>
<div class="sect2">
<h3 id="_fault_tolerant_resource_adaptor"><a class="anchor" href="#_fault_tolerant_resource_adaptor"></a>7.1. The Fault Tolerant Resource Adaptor Object</h3>
<div class="paragraph">
<p>The core of the Fault Tolerant RA API is the <code>org.mobicents.slee.resource.cluster.FaultTolerantResourceAdaptor
				`				interface.
It is intended to be used instead of the `javax.slee.resource.ResourceAdaptor</code>				interface from the JAIN SLEE 1.1 Specification.</p>
</div>
<div class="paragraph">
<p>The FaultTolerant interface provides three new callback methods used by the container:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>setFaultTolerantResourceAdaptorContext(FaultTolerantResourceAdaptorContext context)</code></dt>
<dd>
<p>This method provides the RA with the <code>org.mobicents.slee.resource.cluster.FaultTolerantResourceAdaptorContext
						`						object, which gives access to facilities related with the cluster.
This method is invoked by SLEE after invoking `raConfigure(ConfigProperties properties)</code>						from JAIN SLEE 1.1 specs.</p>
</dd>
<dt class="hdlist1"><code>unsetFaultTolerantResourceAdaptorContext()</code></dt>
<dd>
<p>This method indicates that the RA should remove any references it has to the FaultTolerantResourceAdaptorContext, as it is not valid anymore.
The method is invoked by SLEE before invoking <code>unsetResourceAdaptorContext()</code>						from JAIN SLEE 1.1 specs.</p>
</dd>
<dt class="hdlist1"><code>failOver(K key)</code></dt>
<dd>
<p>Callback from SLEE when the local RA was selected to recover the state for a replicated data key, which was owned by a cluster member that failed.
The RA may then restore any runtime resources associated with such data.</p>
</dd>
<dt class="hdlist1"><code>dataRemoved(K key)</code></dt>
<dd>
<p>Optional callback from SLEE when the replicated data key was removed from the cluster, this may be helpful when the local RA maintains local state.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_fault_tolerant_resource_adaptor_context"><a class="anchor" href="#_fault_tolerant_resource_adaptor_context"></a>7.2. The Fault Tolerant Resource Adaptor Context</h3>
<div class="paragraph">
<p>The clustered RA context follows the contract of JAIN SLEE 1.1 specification interface <code>javax.slee.resource.ResourceAdaptorContext</code>	. It gives access to facilities that the RA may use when run in a clustered environment.</p>
</div>
<div class="paragraph">
<p>The cluster contract is defined in: `org.mobicents.slee.resource.cluster.FaultTolerantResourceAdaptorContext
			`			. It provides critical information, such as if SLEE is running in local mode (not clustered), if it is the head/master member of the cluster, and what the members of the cluster are.</p>
</div>
<div class="sect3">
<h4 id="_fault_tolerant_resource_adaptor_context_replicated_data"><a class="anchor" href="#_fault_tolerant_resource_adaptor_context_replicated_data"></a>7.2.1. The Fault Tolerant Resource Adaptor Replicated Data Sources</h4>
<div class="paragraph">
<p>The Fault Tolerant Resource Adaptor Context provides two data sources to replicate data in cluster:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>ReplicatedData</code></dt>
<dd>
<p>A container for serializable data, which is replicated in the SLEE cluster, but don&#8217;t require any failover.</p>
</dd>
<dt class="hdlist1"><code>ReplicatedDataWithFailover</code></dt>
<dd>
<p>A <code>ReplicatedData</code>							which requires fail over callbacks, this means, that for all data stored here, when a cluster member goes down, the SLEE in another cluster member will invoke the <code>failOver(Key k)</code>							callback in the Fault Tolerant RA object.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When retrieved from the context through a boolean parameter, both types of <code>ReplicatedData</code>				can activate the callback on the <code>FaultTolerantResourceAdaptor</code>				which indicates that a specific data was removed from the cluster remotely.</p>
</div>
</div>
<div class="sect3">
<h4 id="_fault_tolerant_resource_adaptor_context_timer"><a class="anchor" href="#_fault_tolerant_resource_adaptor_context_timer"></a>7.2.2. The Fault Tolerant Resource Adaptor Timer</h4>
<div class="paragraph">
<p>The standard Resource Adaptor Context provides a <code>java.util.Timer</code>, which can be used by the Resource Adaptor to schedule the execution of tasks, the Fault Tolerant Resource Adaptor Context provides <code>org.mobicents.slee.resource.cluster.FaultTolerantTimer</code>, an alternative scheduler which is able to fail over tasks scheduled.</p>
</div>
<div class="paragraph">
<p>The Fault Tolerant Timer has an interface that resembles the JDK&#8217;s <code>ScheduledExecutorService</code>, with two fundamental changes to allow a proper interaction in a cluster environment:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>Task Interface</code></dt>
<dd>
<p>Instead of relying on pure <code>Runnable</code> tasks, tasks must follow a specific interface <code>FaultTolerantTimerTask</code>, to ensure that the timer is able to replicate the task&#8217;s data, and failover the task in any cluster node.</p>
</dd>
<dt class="hdlist1"><code>Task Cancellation</code></dt>
<dd>
<p>Cancellation of task is done through the Timer interface, not through <code>ScheduledFuture</code> objects, this allows the operation to be easily done in any cluster node.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The Fault Tolerant Timer interface:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>cancel(Serializable taskID)</code></dt>
<dd>
<p>Requests the cancellation of the FT Timer Task with the specified ID.</p>
</dd>
<dt class="hdlist1"><code>configure(FaultTolerantTimerTaskFactory taskFactory, int threads)</code></dt>
<dd>
<p>Configures the fault tolerant timer, specifying the timer task factory and the number of threads the timer uses to execute tasks.</p>
</dd>
<dt class="hdlist1"><code>isConfigured()</code></dt>
<dd>
<p>Indicates if the timer is configured.</p>
</dd>
<dt class="hdlist1"><code>schedule(FaultTolerantTimerTask task, long delay, TimeUnit unit)</code></dt>
<dd>
<p>Creates and executes a one-shot action that becomes enabled after the given delay.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><code>scheduleAtFixedRate(FaultTolerantTimerTask task,
			long initialDelay, long period, TimeUnit unit)</code>::
  Creates and executes a periodic action that becomes enabled first after the given initial delay, and subsequently with the given period; that is executions will commence after <code>initialDelay</code> then <code>initialDelay+period</code>, then <code>initialDelay + 2 * period</code>, and so on.
  If any execution of the task encounters an exception, subsequent executions are suppressed.
  Otherwise, the task will only terminate via cancellation or termination of the executor.
  If any execution of this task takes longer than its period, then subsequent executions may start late, but will not concurrently execute.</p>
</div>
<div class="paragraph">
<p><code>scheduleWithFixedDelay(FaultTolerantTimerTask task,
			long initialDelay, long delay, TimeUnit unit)</code>::
  Creates and executes a periodic action that becomes enabled first after the given initial delay, and subsequently with the given delay between the termination of one execution and the commencement of the next.
  If any execution of the task encounters an exception, subsequent executions are suppressed.
  Otherwise, the task will only terminate via cancellation or termination of the executor.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
There is a single Fault Tolerant Timer per RA Entity, and when first retrieved, and before any task can be scheduled, the Fault Tolerant Timer must be configured, through its configure(&#8230;&#8203;) method.
</td>
</tr>
</table>
</div>
<div class="sect4">
<h5 id="_fault_tolerant_resource_adaptor_context_timer_task_and_data"><a class="anchor" href="#_fault_tolerant_resource_adaptor_context_timer_task_and_data"></a>The Fault Tolerant Resource Adaptor Timer Task</h5>
<div class="paragraph">
<p>As mentioned in previous section, tasks submitted to the Fault Tolerant Timer must follow a specific interface, <code>FaulTolerantTimerTask</code>, it is nothing more than a <code>Runnable</code>, which provides the replicable <code>FaultTolerantTimerTaskData</code>.
The task data must be serializable and provide a Serializable task ID, which identifies the task, and may be used to cancel its execution.</p>
</div>
</div>
<div class="sect4">
<h5 id="_fault_tolerant_resource_adaptor_context_timer_example_usage"><a class="anchor" href="#_fault_tolerant_resource_adaptor_context_timer_example_usage"></a>The Fault Tolerant Resource Adaptor Timer Example Usage</h5>
<div class="paragraph">
<p>A simple example for the usage of the Faul Tolerant Timer Task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">// data, task and factory implementation

package org.mobicents.slee.resource.sip11;

import java.io.Serializable;

import org.mobicents.slee.resource.cluster.FaultTolerantTimerTaskData;

public class FaultTolerantTimerTaskDataImpl implements
		FaultTolerantTimerTaskData {

	private final String taskID;

	public FaultTolerantTimerTaskDataImpl(String taskID) {
		this.taskID = taskID;
	}

	@Override
	public Serializable getTaskID() {
		return taskID;
	}
}

package org.mobicents.slee.resource.sip11;

import org.mobicents.slee.resource.cluster.FaultTolerantTimerTask;
import org.mobicents.slee.resource.cluster.FaultTolerantTimerTaskData;
import org.mobicents.slee.resource.cluster.FaultTolerantTimerTaskFactory;

public class FaultTolerantTimerTaskFactoryImpl implements
		FaultTolerantTimerTaskFactory {

	private final SipResourceAdaptor ra;

	public FaultTolerantTimerTaskFactoryImpl(SipResourceAdaptor ra) {
		this.ra = ra;
	}

	@Override
	public FaultTolerantTimerTask getTask(FaultTolerantTimerTaskData data) {
		return new FaultTolerantTimerTaskImpl(ra, data);
	}
}

package org.mobicents.slee.resource.sip11;

import org.mobicents.slee.resource.cluster.FaultTolerantTimerTask;
import org.mobicents.slee.resource.cluster.FaultTolerantTimerTaskData;

public class FaultTolerantTimerTaskImpl implements FaultTolerantTimerTask {

	private final SipResourceAdaptor ra;
	private final FaultTolerantTimerTaskData data;

	public FaultTolerantTimerTaskImpl(SipResourceAdaptor ra,
			FaultTolerantTimerTaskData data) {
		this.ra = ra;
		this.data = data;
	}

	@Override
	public void run() {
		ra.getTracer("FaultTolerantTimerTaskImpl").info("Timer executed.");
	}

	@Override
	public FaultTolerantTimerTaskData getTaskData() {
		return data;
	}
}

// ra code retrieving the timer, configuring it and submiting a task

public void setFaultTolerantResourceAdaptorContext(
		FaultTolerantResourceAdaptorContext&lt;SipActivityHandle, String&gt; context) {
	this.ftRaContext = context;
	FaultTolerantTimer timer = context.getFaultTolerantTimer();
	timer.config(new FaultTolerantTimerTaskFactoryImpl(this), 4);
	FaultTolerantTimerTaskDataImpl data = new FaultTolerantTimerTaskDataImpl("xyz");
	FaultTolerantTimerTaskImpl task = new FaultTolerantTimerTaskImpl(this,
			data);
	timer.schedule(task, 30, TimeUnit.SECONDS);
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_container_clustering_ra_activity_replication"><a class="anchor" href="#_container_clustering_ra_activity_replication"></a>8. Resource Adaptor Activity Replication</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Resource Adaptor API includes an optional component named <code class="class">javax.slee.resource.Marshaler</code>, which is responsible, besides other functions, for converting Activity Handles to byte arrays and vice-versa.
Also relevant, the Resource Adaptor, when starting activities, may provide a flag indicating that the container may marshall the activity (using the Marshaler). In case of a container cluster with data replication, if an activity is to be replicated then the Marshaler must be provided and the activity flags must activate the flag MAY_MARSHALL, otherwise the activity is not replicated and if a node fails all its activities are removed from the container cluster.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The activity replication doesn&#8217;t mean that the activity object is replicated by any means, only the related Activity Handle.
The Resource Adaptor must use the Fault Tolerant RA API or its own means to replicate any additional data to support that presence of the activity in all nodes of the cluster.
Usage of the Fault Tolerant RA API is recommended since it reuses the clustering setup of the container.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_slee_connection_factory"><a class="anchor" href="#_slee_connection_factory"></a>9. Firing Events from Java EE Applications</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_slee_connection_factory_intro"><a class="anchor" href="#_slee_connection_factory_intro"></a>9.1. SLEE Connection Factory</h3>
<div class="paragraph">
<p>The JAIN SLEE specification includes an API for interaction with JAIN SLEE container, with the interface <code class="class">javax.slee.connection.SleeConnectionFactory</code> upfront, which allows external applications, such as an EJB, to create connections to a specific JAIN SLEE instance, and use that to fire events.</p>
</div>
<div class="paragraph">
<p>JAIN SLEE provides two different implementations of the API, one for access in the same JVM, another for remote access.
Both implementations expose the SLEE Connection Factory in the local JNDI tree, thus the same code is used by the application independently of the implementation used.</p>
</div>
<div class="sect3">
<h4 id="local-slee-connection-factory"><a class="anchor" href="#local-slee-connection-factory"></a>9.1.1. Local SLEE Connection Factory</h4>
<div class="paragraph">
<p>JAIN SLEE container instances always expose the local SLEE Connection Factory in its JVM, which means that an external application running in the same JVM doesn&#8217;t need any additional tools or setup to use it.</p>
</div>
</div>
<div class="sect3">
<h4 id="remote-slee-connection-factory"><a class="anchor" href="#remote-slee-connection-factory"></a>9.1.2. Remote SLEE Connection Factory</h4>
<div class="paragraph">
<p>JAIN SLEE includes a tool, named Remote SLEE Connection Tool, which is a JCA connector that can be deployed in any Java EE application server.
Once deployed this connector installs the factory into JNDI, which communicates with the remote SLEE container through RMI.</p>
</div>
<div class="paragraph">
<p>Restcomm Remote SLEE Connection Tool is bundled in all Restcomm JAIN SLEE releases, in the tools/remote-slee-connection directory, including its own documentation.</p>
</div>
</div>
<div class="sect3">
<h4 id="using-slee-connection-factory"><a class="anchor" href="#using-slee-connection-factory"></a>9.1.3. Using SLEE Connection Factory</h4>
<div class="paragraph">
<p>Below is example code which retrieves the SLEE Connection Factory and uses it to fire an event into the JAIN SLEE container.
The code is the same whether the SLEE container is in the same JVM or not.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">	// retrieves JNDI context
	InitialContext context = new InitialContext();

	// retrieves the connection factory from JNDI
	SleeConnectionFactory factory = (SleeConnectionFactory) context.lookup("java:/MobicentsConnectionFactory");

	// creates a connection to the SLEE container
	SleeConnection connection = factory.getConnection();

	// creates the activity handle which will be used to fire the event
	ExternalActivityHandle handle = connection.createActivityHandle();

	// retrieves the event type ID
	EventTypeID eventTypeID = connection.getEventTypeID("CustomEvent", "...", "1.0");

	// creates the event object
	CustomEvent eventObject = new CustomEvent();

	// fires the event in the remote SLEE container
	connection.fireEvent(eventObject, eventTypeID, handle, null);

	// closes the connection
	connection.close();</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_slee_1_1_extensions"><a class="anchor" href="#_slee_1_1_extensions"></a>10. JAIN SLEE 1.1 Extensions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Restcomm  exposes proprietary extensions to the  1.1 specification, to allow the development of easier or more powerful application code.</p>
</div>
<div class="paragraph">
<p>The extensions were discussed among multiple  vendors, and should become part of the standard in next revision, but there is no guarantee that portability won&#8217;t be lost when using those.</p>
</div>
<div class="paragraph">
<p>The extensions source code is available in the Restcomm SLEE Community Git repository, specifically at api/extensions subdirectory.
Its javadocs are bundled in the SLEE binary release, in docs/container/javadoc subdirectory.
The setup for the source project in Eclipse IDE is similar to the container core, as seen in  <a href="#_eclipse_ide">Setting JAIN SLEE Source Code Projects in Eclipse IDE</a>.</p>
</div>
<div class="paragraph">
<p>Java archives (JARs) with compiled classes, javadocs and sources are available in the Sonatype Maven Repository at <a href="https://oss.sonatype.org/content/groups/public/org/mobicents/servers/jainslee/api/jain-slee-11-ext/" class="bare">https://oss.sonatype.org/content/groups/public/org/mobicents/servers/jainslee/api/jain-slee-11-ext/</a></p>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_sbbcontext"><a class="anchor" href="#_slee_1_1_extensions_sbbcontext"></a>10.1. SbbContext Extension</h3>
<div class="paragraph">
<p>This extension to JAIN SLEE 1.1 introduces <em class="path">org.mobicents.slee.SbbContextExt</em> interface, which extends <em class="path">javax.slee.SbbContext</em> with methods to retrieve SLEE factories and facilities, avoiding the usage of JNDI context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.mobicents.slee;

import javax.slee.ActivityContextInterface;
import javax.slee.Sbb;
import javax.slee.SbbContext;
import javax.slee.facilities.ActivityContextNamingFacility;
import javax.slee.facilities.AlarmFacility;
import javax.slee.facilities.TimerFacility;
import javax.slee.nullactivity.NullActivityContextInterfaceFactory;
import javax.slee.nullactivity.NullActivityFactory;
import javax.slee.profile.ProfileFacility;
import javax.slee.profile.ProfileTableActivityContextInterfaceFactory;
import javax.slee.resource.ResourceAdaptorTypeID;
import javax.slee.serviceactivity.ServiceActivityContextInterfaceFactory;
import javax.slee.serviceactivity.ServiceActivityFactory;

public interface SbbContextExt extends SbbContext {

	public Object getActivityContextInterfaceFactory(
			ResourceAdaptorTypeID raTypeID) throws NullPointerException,
			IllegalArgumentException;

	public ActivityContextNamingFacility getActivityContextNamingFacility();

	public AlarmFacility getAlarmFacility();

	public NullActivityContextInterfaceFactory getNullActivityContextInterfaceFactory();

	public NullActivityFactory getNullActivityFactory();

	public ProfileFacility getProfileFacility();

	public ProfileTableActivityContextInterfaceFactory getProfileTableActivityContextInterfaceFactory();

	public Object getResourceAdaptorInterface(ResourceAdaptorTypeID raTypeID,
			String raEntityLink) throws NullPointerException,
			IllegalArgumentException;

	public SbbLocalObjectExt getSbbLocalObject()
			throws TransactionRequiredLocalException, IllegalStateException,
			SLEEException;

	public ServiceActivityContextInterfaceFactory getServiceActivityContextInterfaceFactory();

	public ServiceActivityFactory getServiceActivityFactory();

	public TimerFacility getTimerFacility();
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>getActivityContextInterfaceFactory(ResourceAdaptorTypeID)</code> method</dt>
<dd>
<p>Retrieves the ActivityContextInterface factory for the Resource Adaptor Type with the specified ID.</p>
</dd>
<dt class="hdlist1">The <code>getActivityContextNamingFacility()</code> method</dt>
<dd>
<p>Retrieves the Activity Context Naming Facility.</p>
</dd>
<dt class="hdlist1">The <code>getAlarmFacility()</code> method</dt>
<dd>
<p>Retrieves the Alarm Facility.</p>
</dd>
<dt class="hdlist1">The <code>getNullActivityContextInterfaceFactory()</code> method</dt>
<dd>
<p>Retrieves the Null Activity Context Interface Factory.</p>
</dd>
<dt class="hdlist1">The <code>getNullActivityFactory()</code> method</dt>
<dd>
<p>Retrieves the Null Activity Factor.</p>
</dd>
<dt class="hdlist1">The <code>getProfileFacility()</code> method</dt>
<dd>
<p>Retrieves the Profile Facility.</p>
</dd>
<dt class="hdlist1">The <code>getProfileTableActivityContextInterfaceFactory()</code> method</dt>
<dd>
<p>Retrieves the Profile Table Activity Context Interface Factory.</p>
</dd>
<dt class="hdlist1">The <code>getResourceAdaptorInterface(ResourceAdaptorTypeID,String)</code> method</dt>
<dd>
<p>Retrieves the interface to interact with a specific Resource Adaptor entity, identified by both the entity link name and the Resource Adaptor Type ID.</p>
</dd>
<dt class="hdlist1">The <code>getSbbLocalObject()</code> method</dt>
<dd>
<p>Exposes the SBB local object with the extension interface to avoid unneeded casts.</p>
</dd>
<dt class="hdlist1">The <code>getServiceActivityContextInterfaceFactory()</code> method</dt>
<dd>
<p>Retrieves the Service Activity Context Interface Factory.</p>
</dd>
<dt class="hdlist1">The <code>getServiceActivityFactory()</code> method</dt>
<dd>
<p>Retrieves the Service Activity Factory.</p>
</dd>
<dt class="hdlist1">The <code>getTimerFacility()</code> method</dt>
<dd>
<p>Retrieves the Timer Facility.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_cr"><a class="anchor" href="#_slee_1_1_extensions_cr"></a>10.2. ChildRelation Extension</h3>
<div class="paragraph">
<p>This extension to JAIN SLEE 1.1 introduces the <code class="method">org.mobicents.slee.ChildRelationExt</code> interface, which extends <code class="class">javax.slee.ChildRelation</code> with methods to create and retrieve SBB entities by name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.mobicents.slee;

public interface ChildRelationExt extends ChildRelation {

	public SbbLocalObjectExt create(String name) throws CreateException,
			TransactionRequiredLocalException, SLEEException;

	public SbbLocalObjectExt get(String name)
			throws TransactionRequiredLocalException, SLEEException;

}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>create(String)</code> method</dt>
<dd>
<p>Creates a new SBB entity of the SBB type associated with the relation, with the specified name.
The new SBB entity is automatically added to the relationship collection.
The returned object may be cast to the required local interface type using the normal Java typecast mechanism.
This method is a mandatory transactional method.</p>
</dd>
<dt class="hdlist1">The <code>get(String)</code> method</dt>
<dd>
<p>Retrieves the SBB entity associated with the child relation with the specified name.
This method is a mandatory transactional method.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_sbblo"><a class="anchor" href="#_slee_1_1_extensions_sbblo"></a>10.3. SbbLocalObject Extension</h3>
<div class="paragraph">
<p>This extension to JAIN SLEE 1.1 introduces the <code class="method">org.mobicents.slee.SbbLocalObjectExt</code> interface, which extends <code class="class">javax.slee.SbbLocalObject</code> with methods to retrieve the parent SBB Entity, if any, and to also retrieve information such as the child name, and the parent child relation name.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.mobicents.slee;

public interface SbbLocalObjectExt extends SbbLocalObject {

	public String getChildRelation() throws TransactionRequiredLocalException,
			SLEEException;

	public String getName() throws NoSuchObjectLocalException,
			TransactionRequiredLocalException, SLEEException;

	public SbbLocalObjectExt getParent() throws NoSuchObjectLocalException,
			TransactionRequiredLocalException, SLEEException;
}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>getChildRelation()</code> method</dt>
<dd>
<p>Retrieves the name of the child relation used to create this object.
This method is a mandatory transactional method.</p>
</dd>
<dt class="hdlist1">The <code>getName()</code> method</dt>
<dd>
<p>Retrieves the name of the object.
This method is a mandatory transactional method.</p>
</dd>
<dt class="hdlist1">The <code>getParent()</code> method</dt>
<dd>
<p>Retrieves the parent SBB object.
This method is a mandatory transactional method.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_profilecontext"><a class="anchor" href="#_slee_1_1_extensions_profilecontext"></a>10.4. ProfileContext Extension</h3>
<div class="paragraph">
<p>This extension to JAIN SLEE 1.1 introduces <em class="path">org.mobicents.slee.ProfileContextExt</em> interface, which extends <em class="path">javax.slee.ProfileContext</em> with methods to retrieve SLEE alarm facility, avoiding the usage of JNDI context.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.mobicents.slee;

import javax.slee.facilities.AlarmFacility;
import javax.slee.profile.Profile;
import javax.slee.profile.ProfileContext;

public interface ProfileContextExt extends ProfileContext {

	public AlarmFacility getAlarmFacility();

}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>getAlarmFacility()</code> method</dt>
<dd>
<p>Retrieves the Alarm Facility.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_aci"><a class="anchor" href="#_slee_1_1_extensions_aci"></a>10.5. ActivityContextInterface Extension</h3>
<div class="paragraph">
<p>This simple extension to JAIN SLEE 1.1 introduces <em class="path">org.mobicents.slee.ActivityContextInterfaceExt</em> interface, which extends <em class="path">javax.slee.ActivityContextInterface</em> with methods to retrieve the timers and names bound to the ACI.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">package org.mobicents.slee;

import javax.slee.ActivityContextInterface;
import javax.slee.facilities.TimerID;

public interface ActivityContextInterfaceExt extends ActivityContextInterface {

	public TimerID[] getTimers();

	public String[] getNamesBound();

}</code></pre>
</div>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">The <code>getTimers()</code> method</dt>
<dd>
<p>Retrieves the IDs of timers currently set which are related to the ACI.</p>
</dd>
<dt class="hdlist1">The <code>getNamesBound()</code> method</dt>
<dd>
<p>Retrieves the names currently bound to the ACI.</p>
</dd>
<dt class="hdlist1">The <code>suspend()</code> method</dt>
<dd>
<p>This feature may be used before attaching to an ActivityContextInterface, to ensure that any event fired concurrently will be received.
It suspends routing of events in the activity context immediately, till the active transaction ends.</p>
</dd>
</dl>
</div>
</div>
<div class="sect2">
<h3 id="_slee_1_1_extensions_library_references"><a class="anchor" href="#_slee_1_1_extensions_library_references"></a>10.6. Library References Extension</h3>
<div class="paragraph">
<p>JAIN SLEE 1.1 standard introduced the Library component, a wrapper for a set of jars and/or classes to be referenced and used by other components types, such as SBBs.</p>
</div>
<div class="paragraph">
<p>The usage of the standard Library component is very limited, each Library can only refer other Library components.
Due to this limitation a developer may not be able to include classes in a Library that depend, just as example, on Resource Adaptor Type interfaces, unless of course those interfaces are in a Library too.</p>
</div>
<div class="paragraph">
<p>This extension allows libraries to reference other component types, which the developer should use when the classes in the Library need to use classes from that component, by simply extending the JAIN SLEE 1.1 Library Jar XML descriptor.</p>
</div>
<div class="sect3">
<h4 id="_slee_1_1_ext_library_jar_xml_descriptor_dtd"><a class="anchor" href="#_slee_1_1_ext_library_jar_xml_descriptor_dtd"></a>10.6.1. Extended Library Jar XML Descriptor DTD</h4>
<div class="paragraph">
<p>The DTD document changes for the extended library jar XML descriptor:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;!--
The library element defines a library.  It contains an optional description
about the library, the name, vendor, and version of the library being defined,
zero or more references to any other components that this library
depends on, and information about zero or more jar files that contain
prepackaged classes and resources to be included with the library.

The classes and resources for a library are the sum total of the classes and
resources contained in:
- the library component jar itself (if any)
- the library jars specified by the jar elements (if any)

All these classes are loaded by the same classloader.

Used in: library-jar
--&gt;
&lt;!ELEMENT library (description?, library-name, library-vendor, library-version,
 event-type-ref*, library-ref*, profile-spec-ref*, resource-adaptor-type-ref*,
 sbb-ref*, jar*)&gt;

&lt;!--
The event-type-ref element identifies an event type that the library classes depend.
It contains the name, vendor,and version of the event type.

Used in: library
--&gt;
&lt;!ELEMENT event-type-ref (event-type-name, event-type-vendor,
          event-type-version)&gt;

&lt;!--
The event-type-name element contains the name of an event type referred by
the library.

Used in: event-type-ref

Example:
    &lt;event-type-name&gt;
        javax.csapi.cc.jcc.JccCallEvent.CALL_CREATED
    &lt;/event-type-name&gt;
--&gt;
&lt;!ELEMENT event-type-name (#PCDATA)&gt;

&lt;!--
The event-type-vendor element contains the vendor of an event type referred by
the library

Used in: event-type-ref

Example:
    &lt;event-type-vendor&gt;javax.csapi.cc.jcc&lt;/event-type-vendor&gt;
--&gt;
&lt;!ELEMENT event-type-vendor (#PCDATA)&gt;

&lt;!--
The event-type-version element contains the version of an event type referred by
the library

Used in: event-type-ref

Example:
    &lt;event-type-version&gt;1.1&lt;/event-type-version&gt;
--&gt;
&lt;!ELEMENT event-type-version (#PCDATA)&gt;

&lt;!--
The profile-spec-ref element identifies an profile specification that the library
classes depend. It contains an optional description about the reference, and the
name, vendor, and version of the referenced profile specification.

Used in: library
--&gt;
&lt;!ELEMENT profile-spec-ref (description?, profile-spec-name,
          profile-spec-vendor, profile-spec-version)&gt;

&lt;!--
The profile-spec-name element contains the name of a profile specification
component.

Used in: profile-spec-ref

Example:
    &lt;profile-spec-name&gt;AddressProfileSpec&lt;/profile-spec-name&gt;
--&gt;
&lt;!ELEMENT profile-spec-name (#PCDATA)&gt;

&lt;!--
The profile-spec-vendor element contains the vendor of a profile specification
component.

Used in: profile-spec-ref

Example:
    &lt;profile-spec-name&gt;javax.slee&lt;/profile-spec-name&gt;
--&gt;
&lt;!ELEMENT profile-spec-vendor (#PCDATA)&gt;

&lt;!--
The profile-spec-version element contains the version of a profile
specification component.

Used in: profile-spec-ref

Example:
    &lt;profile-spec-version&gt;1.0&lt;/profile-spec-version&gt;
--&gt;
&lt;!ELEMENT profile-spec-version (#PCDATA)&gt;

&lt;!--
The resource-adaptor-type-ref element identifies an resource adaptor type that the
library classes depend. It contains the name, vendor,and version of the RA type.

Used in: library
--&gt;
&lt;!ELEMENT resource-adaptor-type-ref (resource-adaptor-type-name,
 		  resource-adaptor-type-vendor, resource-adaptor-type-version)&gt;

&lt;!--
The resource-adaptor-type-name element contains the name of a resource
adaptor type component referred by the library.

Used in: resource-adaptor-type-ref

Example:
    &lt;resource-adaptor-type-name&gt;JCC&lt;/resource-adaptor-type-name&gt;
--&gt;
&lt;!ELEMENT resource-adaptor-type-name (#PCDATA)&gt;

&lt;!--
The resource-adaptor-type-vendor element contains the vendor of a resource
adaptor type component referred by the library.

Used in: resource-adaptor-type-ref

Example:
    &lt;resource-adaptor-type-vendor&gt;
        javax.csapi.cc.jcc
    &lt;/resource-adaptor-type-vendor&gt;
--&gt;
&lt;!ELEMENT resource-adaptor-type-vendor (#PCDATA)&gt;

&lt;!--
The resource-adaptor-type-version element contains the version of a resource
adaptor type component referred by the library.

Used in: resource-adaptor-type-ref

Example:
    &lt;resource-adaptor-type-version&gt;1.1&lt;/resource-adaptor-type-version&gt;
--&gt;
&lt;!ELEMENT resource-adaptor-type-version (#PCDATA)&gt;

&lt;!--
The sbb-ref element identifies an SBB that the library classes depend.
It contains the name, vendor,and version of the SBB.

Used in: library
--&gt;
&lt;!ELEMENT sbb-ref (sbb-name, sbb-vendor,
          sbb-version)&gt;

&lt;!--
The sbb-name element contains the name of a SBB component referred
 by the library.


Used in: sbb-ref

Example:
    &lt;sbb-name&gt;MySbb&lt;/sbb-name&gt;
--&gt;
&lt;!ELEMENT sbb-name (#PCDATA)&gt;

&lt;!--
The sbb-vendor element contains the vendor of a SBB component referred
 by the library.

Used in: sbb-ref

Example:
    &lt;sbb-vendor&gt;My Company, Inc.&lt;/sbb-vendor&gt;
--&gt;
&lt;!ELEMENT sbb-vendor (#PCDATA)&gt;

&lt;!--
The sbb-version element contains the version of a SBB component referred
 by the library.

Used in: sbb-ref

Example:
    &lt;sbb-version&gt;1.0&lt;/sbb-version&gt;
--&gt;
&lt;!ELEMENT sbb-version (#PCDATA)&gt;

&lt;!--
The ID mechanism is to allow tools that produce additional deployment
information (ie. information beyond that contained by the standard SLEE
deployment descriptors) to store the non-standard information in a separate
file, and easily refer from those tools-specific files to the information in
the standard deployment descriptor.  The SLEE architecture does not allow the
tools to add the non-standard information into the SLEE-defined deployment
descriptors.
--&gt;
&lt;!ATTLIST library-jar id ID #IMPLIED&gt;
&lt;!ATTLIST description id ID #IMPLIED&gt;
&lt;!ATTLIST library id ID #IMPLIED&gt;
&lt;!ATTLIST library-name id ID #IMPLIED&gt;
&lt;!ATTLIST library-vendor id ID #IMPLIED&gt;
&lt;!ATTLIST library-version id ID #IMPLIED&gt;
&lt;!ATTLIST event-type-ref id ID #IMPLIED&gt;
&lt;!ATTLIST event-type-name id ID #IMPLIED&gt;
&lt;!ATTLIST event-type-vendor id ID #IMPLIED&gt;
&lt;!ATTLIST event-type-version id ID #IMPLIED&gt;
&lt;!ATTLIST library-ref id ID #IMPLIED&gt;
&lt;!ATTLIST profile-spec-ref id ID #IMPLIED&gt;
&lt;!ATTLIST profile-spec-name id ID #IMPLIED&gt;
&lt;!ATTLIST profile-spec-vendor id ID #IMPLIED&gt;
&lt;!ATTLIST profile-spec-version id ID #IMPLIED&gt;
&lt;!ATTLIST resource-adaptor-type-ref id ID #IMPLIED&gt;
&lt;!ATTLIST resource-adaptor-type-name id ID #IMPLIED&gt;
&lt;!ATTLIST resource-adaptor-type-vendor id ID #IMPLIED&gt;
&lt;!ATTLIST resource-adaptor-type-version id ID #IMPLIED&gt;
&lt;!ATTLIST sbb-ref id ID #IMPLIED&gt;
&lt;!ATTLIST sbb-name id ID #IMPLIED&gt;
&lt;!ATTLIST sbb-vendor id ID #IMPLIED&gt;
&lt;!ATTLIST sbb-version id ID #IMPLIED&gt;
&lt;!ATTLIST jar id ID #IMPLIED&gt;
&lt;!ATTLIST jar-name id ID #IMPLIED&gt;
&lt;!ATTLIST security-permissions id ID #IMPLIED&gt;
&lt;!ATTLIST security-permission-spec id ID #IMPLIED&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This full DTD is available at <a href="https://raw.githubusercontent.com/RestComm/jain-slee/master/api/descriptors/library/src/main/resources/slee-library-jar_1_1-ext.dtd" class="bare">https://raw.githubusercontent.com/RestComm/jain-slee/master/api/descriptors/library/src/main/resources/slee-library-jar_1_1-ext.dtd</a></p>
</div>
</div>
<div class="sect3">
<h4 id="_slee_1_1_ext_library_jar_xml_descriptor_example"><a class="anchor" href="#_slee_1_1_ext_library_jar_xml_descriptor_example"></a>10.6.2. Extended Library Jar XML Descriptor Example</h4>
<div class="paragraph">
<p>The following XML descriptor examples the definition of references to JAIN SLEE 1.1 Component types other than Library</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE library-jar PUBLIC
		"-//Sun Microsystems, Inc.//DTD JAIN SLEE Ext Library 1.1//EN"
		"https://raw.githubusercontent.com/RestComm/jain-slee/master/api/descriptors/library/src/main/resources/slee-library-jar_1_1-ext.dtd"&gt;

&lt;library-jar&gt;
	&lt;library&gt;
		&lt;library-name&gt;extended-library-example&lt;/library-name&gt;
		&lt;library-vendor&gt;com.redhat&lt;/library-vendor&gt;
		&lt;library-version&gt;1.0&lt;/library-version&gt;

		&lt;event-type-ref&gt;
			&lt;event-type-name&gt;ExampleX&lt;/event-type-name&gt;
			&lt;event-type-vendor&gt;com.redhat&lt;/event-type-vendor&gt;
			&lt;event-type-version&gt;1.0&lt;/event-type-version&gt;
		&lt;/event-type-ref&gt;

		&lt;library-ref&gt;
			&lt;library-name&gt;LibraryX&lt;/library-name&gt;
			&lt;library-vendor&gt;com.redhat&lt;/library-vendor&gt;
			&lt;library-version&gt;1.0&lt;/library-version&gt;
		&lt;/library-ref&gt;

		&lt;profile-spec-ref&gt;
			&lt;profile-spec-name&gt;ProfileX&lt;/profile-spec-name&gt;
			&lt;profile-spec-vendor&gt;com.redhat&lt;/profile-spec-vendor&gt;
			&lt;profile-spec-version&gt;1.0&lt;/profile-spec-version&gt;
		&lt;/profile-spec-ref&gt;

		&lt;resource-adaptor-type-ref&gt;
			&lt;resource-adaptor-type-name&gt;ResourceAdaptorTypeX&lt;/resource-adaptor-type-name&gt;
			&lt;resource-adaptor-type-vendor&gt;com.redhat&lt;/resource-adaptor-type-vendor&gt;
			&lt;resource-adaptor-type-version&gt;1.0&lt;/resource-adaptor-type-version&gt;
		&lt;/resource-adaptor-type-ref&gt;

		&lt;sbb-ref&gt;
			&lt;sbb-name&gt;SbbX&lt;/sbb-name&gt;
			&lt;sbb-vendor&gt;com.redhat&lt;/sbb-vendor&gt;
			&lt;sbb-version&gt;1.0&lt;/sbb-version&gt;
		&lt;/sbb-ref&gt;

	&lt;/library&gt;
&lt;/library-jar&gt;</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Note how the DOCTYPE element is set to the extended DTD instead of the standard one.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="advanced-topics"><a class="anchor" href="#advanced-topics"></a>11. Advanced Topics</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_classloading"><a class="anchor" href="#_classloading"></a>11.1. Class Loading</h3>
<div class="paragraph">
<p>Each JAIN SLEE Component has its own classloader (<code>ComponentClassLoader</code>) in the package named <code>org.mobicents.slee.container.component.deployment.classloading</code>.
This classloader sees the component classes contained in the component jar (<code>URLClassLoaderDomain</code>) by declaring it as the parent classloader, and adding the classes seen by each component it refers.
It does not see classes from a component that it does not depend on.</p>
</div>
<div class="paragraph">
<p>JAIN SLEE defines a class loading domain with the s required in the JAIN SLEE 1.1 container (for example, JAIN SLEE,  and ). This domain (<code>JBoss Microcontainer ClassLoadingDomain</code>) imports all classes shared in the JBoss Application Server , and acts like the parent domain for all <code>URLClassLoaderDomain</code>s, which means that a class imported by a SLEE classloading domain will always be used first.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/classloading.png" alt="classloading">
</div>
<div class="title">Figure 3. Classloading example in Restcomm  JAIN SLEE</div>
</div>
<div class="ulist">
<ul>
<li>
<p>The <code>SIP INVITE Event</code> component refers to the <code>JAIN SIP Library</code> in its XML descriptor, and its classloader domain depends on the classloader domain of the JAIN SIP Library.</p>
</li>
<li>
<p>The <code>SIP RA Type</code> component refers to all Events in the SIP RA Event jar in its XML descriptor, and its classloader domain depends on the classloader domain of the SIP Event JAR and inherits its dependencies, including the JAIN SIP library classloading domain.</p>
</li>
<li>
<p>The <code>SIP RA</code> component refers to the <code>SIP RA Type</code> component in its XML descriptor, and its classloader domain depends on the classloader domain of the SIP RA Type Component jar, and inherits its dependencies.
This includes the SIP Event jar and JAIN SIP library classloading domains.</p>
</li>
<li>
<p>The <code>SBB</code> component refers to the <code>SIP RA Type</code> component and <code>SIP INVITE Event</code> in its XML descriptor.
Its classloader domain depends on the class loader domain of the SIP RA Type Component jar, and inherits its dependencies; the SIP Event jar and the JAIN SIP library classloading domains.
It also depends on the classloader domain of the SIP Event jar.</p>
</li>
</ul>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
JBoss Application Server does not see the classes of deployed JAIN SLEE components.
This means that if it exports its classes for components that are complemented with Java EE components, the common classes must be deployed on JBoss Application Server , either directly or included in the Java EE component.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="congestion-control"><a class="anchor" href="#congestion-control"></a>11.2. Congestion Control</h3>
<div class="paragraph">
<p>JAIN SLEE can monitor the memory available in the JVM.
In case it drops to a certain level (percentage), new events and/or activity startups are rejected, and at the same time a JAIN SLEE Alarm (which can send JMX notifications) is raised.
This feature is called Congestion Control, and the container will turn it off automatically once another available memory level is reached.</p>
</div>
<div class="paragraph">
<p>If Congestion Control rejects an operation, a <code class="class">javax.slee.SleeException</code> is thrown.
This means that if the feature is to be used, the Resource Adaptors and Applications need to handle such use case, and behave properly.</p>
</div>
<div class="paragraph">
<p>The type of JAIN SLEE Alarm raised is <code class="app">org.mobicents.slee.management.alarm.congestion</code>.</p>
</div>
<div class="paragraph">
<p>Congestion Control is turned off by default.</p>
</div>
<div class="sect3">
<h4 id="_congestion_control_configuration"><a class="anchor" href="#_congestion_control_configuration"></a>11.2.1. Congestion Control Configuration</h4>
<div class="paragraph">
<p>The Congestion Control feature is configured through an XML file or through a JMX MBean.
Changes applied through JMX are not persisted, and once the container is restarted the configuration will revert to the one in the XML file.</p>
</div>
<div class="sect4">
<h5 id="congestion-control-persistent-configuration"><a class="anchor" href="#congestion-control-persistent-configuration"></a>Congestion Control Persistent Configuration</h5>
<div class="paragraph">
<p>Configuration is done through a XML descriptor for each <a href="#_server_profiles">Server Profiles</a>.
The XML file is named <em class="path">jboss-beans.xml</em> and is located at <em class="path">$JBOSS_HOME/server/profile_name/deploy/restcomm-slee/META-INF</em>, where <code class="app">profile_name</code> is the server profile name.</p>
</div>
<div class="paragraph">
<p>The configuration is exposed a JBoss Microcontainer Bean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;bean name="Mobicents.JAINSLEE.CongestionControlConfiguration"
	class="org.mobicents.slee.container.management.jmx.CongestionControlConfiguration"&gt;
	&lt;annotation&gt;@org.jboss.aop.microcontainer.aspects.jmx.JMX(name=
		"org.mobicents.slee:name=CongestionControlConfiguration",exposedInterface=
		org.mobicents.slee.container.management.jmx.CongestionControlConfigurationMBean.class,
		registerDirectly=true)&lt;/annotation&gt;
	&lt;property name="periodBetweenChecks"&gt;0&lt;/property&gt;
	&lt;property name="minFreeMemoryToTurnOn"&gt;10&lt;/property&gt;
	&lt;property name="minFreeMemoryToTurnOff"&gt;20&lt;/property&gt;
	&lt;property name="refuseStartActivity"&gt;true&lt;/property&gt;
	&lt;property name="refuseFireEvent"&gt;false&lt;/property&gt;
&lt;/bean&gt;</code></pre>
</div>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 7. JAIN SLEE Congestion Control Bean Configuration</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property Name</th>
<th class="tableblock halign-left valign-top">Property Type</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">periodBetweenChecks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The available memory level is checked periodically, this property defines the period, in seconds, between these checks, and if set to 0 turns off the Congestion Control feature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minFreeMemoryToTurnOn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This property defines the minimum free memory percentage, which if reached turns ON the Congestion Control feature.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">minFreeMemoryToTurnOff</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">This property defines the minimum free memory percentage, which if reached turns OFF the Congestion Control feature. This value should be considerably higher than minFreeMemoryToTurnOn, otherwise the feature may be turning on and off all the time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">refuseStartActivity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true and the Congestion Control feature is ON, the container rejects activity startups, no matter it&#8217;s a request from a Resource Adaptor or SBB.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">refuseFireEvent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If true and the Congestion Control feature is ON, the container rejects the firing of events, no matter it&#8217;s a request from a Resource Adaptor or SBB.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4">
<h5 id="congestion-control-jmx-configuration"><a class="anchor" href="#congestion-control-jmx-configuration"></a>Congestion Control JMX Configuration</h5>
<div class="paragraph">
<p>Through JMX, the Congestion Control feature configuration can be changed with the container running.
These configuration changes are not persisted.</p>
</div>
<div class="paragraph">
<p>The JMX MBean which can be used to change the Congestion Control configuration is named <code class="app">org.mobicents.slee:name=CongestionControlConfiguration</code>, and provides getters and setters to change each property defined in the persistent configuration.
The JMX Console can be used to use this MBean, see <a href="#_management_jmx_console">JMX Console</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_jpa_slee_profiles_mapping"><a class="anchor" href="#_jpa_slee_profiles_mapping"></a>11.3. JAIN SLEE 1.1 Profiles JPA Mapping</h3>
<div class="paragraph">
<p>As mentioned in the containers configuration section, Restcomm JAIN SLEE uses JPA to store all JAIN SLEE 1.1 Profiles, and in mentioned section it was explained how to define which JPA / Hibernate data source.
In this section more details are provided about how JAIN SLEE 1.1 Profiles are mapped to a JPA datasource schema.</p>
</div>
<div class="sect3">
<h4 id="_profile_jpa_tables_and_columns"><a class="anchor" href="#_profile_jpa_tables_and_columns"></a>11.3.1. Profile Specification JPA Tables And columns</h4>
<div class="paragraph">
<p>For each Profile Specification, at least one  Table is created, and is named <code>SLEE_PE_</code> concatenated with the Profile CMP interface simple name (<code>obtained as java.lang.Class.getSimpleName()</code>), then <code>_</code>, and finally the absolute value of the <code>hashCode()</code> method of the javax.slee.ComponentID of the Profile Specification.</p>
</div>
<div class="paragraph">
<p>This table has a primary key composed by the profile name and profile table name, and a column for each attribute of the Profile Specification CMP, except for those of array type.
Those columns are named <code>C</code>, concatenated with the cmp attribute name.</p>
</div>
<div class="paragraph">
<p>For each Profile CMP attribute of <code class="parameter">array</code> type, a join table is created, and is named <code>SLEE_PEAAV_</code> concatenated with the Profile CMP interface simple name (<code>obtained as java.lang.Class.getSimpleName()</code>), then <code>_</code>, then the absolute value of <code>hashCode()</code> method of the javax.slee.ComponentID of the Profile Specification, and finally the CMP attribute name.
This table has a generated primary key column named <code>ID</code>, the foreign key, and two columns to store the CMP attribute value:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>SERIALIZABLE</code></dt>
<dd>
<p>Used to store the value if its type does not allow it to be converted to a String.</p>
</dd>
<dt class="hdlist1"><code>STRING</code></dt>
<dd>
<p>Used when the CMP attribute type can be converted to a <code>java.lang.String</code>, for instance an <code>Integer</code>.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_profile_jpa_datasource"><a class="anchor" href="#_profile_jpa_datasource"></a>11.3.2. Profile Specification JPA Datasource</h4>
<div class="paragraph">
<p>Unless configured manually, Restcomm JAIN SLEE uses the default datasource of &amp;JEE.PLATFORM;.
Please refer to its documentation to learn about it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_testing_tck"><a class="anchor" href="#_testing_tck"></a>11.4. Testing the JAIN SLEE 1.1 TCK</h3>
<div class="paragraph">
<p>To run the JAIN SLEE 1.1 TCK:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Checkout and build the container source code as explained in <a href="#_install">Installing Restcomm  JAIN SLEE</a>.</p>
</li>
<li>
<p>Install the TCK Resource Adaptor and Plugin:</p>
<div class="listingblock">
<div class="content">
<pre>cd tck/jain-slee-1.1
mvn install</pre>
</div>
</div>
</li>
<li>
<p>Setup JAVA_OPTS environment variable to include -XX:MaxPermSize=128M -Djboss.defined.home=<code>/Volumes/2/jboss-5.1.0.GA</code> -Djava.security.manager=default -Djava.security.policy=<code><a href="file:///Volumes/2/workspace/restcomm-jainslee-2/" class="bare">file:///Volumes/2/workspace/restcomm-jainslee-2/</a></code>tck/jain-slee-1.1/tck-security.policy, replacing the <code>absolute paths</code> with $JBOSS_HOME and the path of the Git checkout.</p>
</li>
<li>
<p>Unzip and run the JAIN SLEE 1.1 TCK distribution:</p>
<div class="listingblock">
<div class="content">
<pre>unzip testsuite.zip
cd testsuite
ant</pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
No test should fail.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_eclipse_ide"><a class="anchor" href="#_eclipse_ide"></a>11.5. Setting JAIN SLEE Source Code Projects in Eclipse IDE</h3>
<div class="paragraph">
<p>The JAIN SLEE Core, each RA, and each example, are worked out with separated Eclipse IDE Projects.</p>
</div>
<div class="paragraph">
<p>There are two alternatives to set up a specific project:</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Via Command Line</div>
<ol class="arabic">
<li>
<p>In the checked out directory of the project, and with Eclipse IDE closed, open a terminal.</p>
</li>
<li>
<p>Run the following:</p>
<div class="listingblock">
<div class="content">
<pre>]mvn restcomm:eclipse
mvn -Declipse.workspace=YOUR_RELATIVE_PATH_TO_ECLIPSE_WORKSPACE eclipse:add-maven-repo</pre>
</div>
</div>
</li>
<li>
<p>Install M2Eclipse if you want to do maven builds within Eclipse.</p>
</li>
</ol>
</div>
<div class="olist arabic">
<div class="title">Procedure: With Eclipse IDE</div>
<ol class="arabic">
<li>
<p>Install the M2Eclipse plugin and use "Import&#8230;&#8203;" and subselect the "Maven Projects" feature.</p>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Ensure the "Resolve Workspace projects" and "Separate projects for modules" in the "Advanced" options on the bottom of the window are turned off.
If the project is large, such as the JAIN SLEE Core, M2Eclipse may be a considerable slower option, due to dynamic Maven2 Dependency Management.
</td>
</tr>
</table>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jdk_installing_configuring_and_running"><a class="anchor" href="#_jdk_installing_configuring_and_running"></a>Appendix A: Java Development Kit (): Installing, Configuring and Running</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The [app]` Platform` is written in Java; therefore, before running any <code class="app"> server, you must have a working Java Runtime Environment () or Java Development Kit () installed on your system.
In addition, the JRE or JDK you are using to run [app]</code> must be version 5 or higher<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnote_1" title="View footnote.">1</a>]</sup>.</p>
</div>
<div class="paragraph">
<div class="title">Should I Install the JRE or JDK?</div>
<p>Although you can run <code class="app"> servers using the Java Runtime Environment, we assume that most users are developers interested in developing Java-based, [app]</code>-driven solutions.
Therefore, in this guide we take the tact of showing how to install the full Java Development Kit.</p>
</div>
<div class="paragraph">
<div class="title">Should I Install the 32-Bit or the 64-Bit JDK, and Does It Matter?</div>
<p>Briefly stated: if you are running on a 64-Bit Linux or Windows platform, you should consider installing and running the 64-bit JDK over the 32-bit one.
Here are some heuristics for determining whether you would rather run the 64-bit Java Virtual Machine (JVM) over its 32-bit cousin for your application:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Wider datapath: the pipe between RAM and CPU is doubled, which improves the performance of memory-bound applications when using a 64-bit JVM.</p>
</li>
<li>
<p>64-bit memory addressing gives virtually unlimited (1 exabyte) heap allocation.
However large heaps affect garbage collection.</p>
</li>
<li>
<p>Applications that run with more than 1.5 GB of RAM (including free space for garbage collection optimization) should utilize the 64-bit JVM.</p>
</li>
<li>
<p>Applications that run on a 32-bit JVM and do not require more than minimal heap sizes will gain nothing from a 64-bit JVM.
Barring memory issues, 64-bit hardware with the same relative clock speed and architecture is not likely to run Java applications faster than their 32-bit cousin.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Note that the following instructions detail how to download and install the 32-bit JDK, although the steps are nearly identical for installing the 64-bit version.</p>
</div>
<div class="paragraph">
<div class="title">Downloading</div>
<p>You can download the Sun JDK 5.0 (Java 2 Development Kit) from Sun&#8217;s website: <a href="http://java.sun.com/javase/downloads/index_jdk5.jsp" class="bare">http://java.sun.com/javase/downloads/index_jdk5.jsp</a>.
Click on the <span class="label">Download</span> link next to "JDK 5.0 Update <code class="replaceable">&lt;x&gt;`" (where [replaceable]</code>&lt;x&gt;` is the latest minor version release number). On the next page, select your language and platform (both architecture&#8212;&#8203;whether 32- or 64-bit&#8212;&#8203;and operating system), read and agree to the <code>Java Development Kit 5.0 License Agreement</code>, and proceed to the download page.</p>
</div>
<div class="paragraph">
<p>The Sun website will present two download alternatives to you: one is an RPM inside a self-extracting file (for example, <em class="path">jdk-1_5_0_16-linux-i586-rpm.bin</em>), and the other is merely a self-extracting file (e.g. <em class="path">jdk-1_5_0_16-linux-i586.bin</em>). If you are installing the JDK on Red Hat Enterprise Linux, Fedora, or another RPM-based Linux system, we suggest that you download the self-extracting file containing the RPM package, which will set up and use the SysV service scripts in addition to installing the JDK.
We also suggest installing the self-extracting RPM file if you will be running [app]`` in a production environment.</p>
</div>
<div class="paragraph">
<div class="title">Installing</div>
<p>The following procedures detail how to install the Java Development Kit on both Linux and Windows.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: Installing the JDK on Linux</div>
<ol class="arabic">
<li>
<p>Regardless of which file you downloaded, you can install it on Linux by simply making sure the file is executable and then running it:</p>
<div class="listingblock">
<div class="content">
<pre>~]$ chmod +x "jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"
~]$ ./"jdk-1_5_0_&lt;minor_version&gt;-linux-&lt;architecture&gt;-rpm.bin"</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">You Installed Using the Non-RPM Installer, but Want the SysV Service Scripts</div>
<div class="paragraph">
<p>If you download the non-RPM self-extracting file (and installed it), and you are running on an RPM-based system, you can still set up the SysV service scripts by downloading and installing one of the <code>-compat</code> packages from the JPackage project.
Remember to download the <code>-compat</code> package which corresponds correctly to the minor release number of the JDK you installed.
The compat packages are available from link:ftp://jpackage.hmdc.harvard.edu/JPackage/1.7/generic/RPMS.non-free/.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
You do not need to install a <code>-compat</code> package in addition to the JDK if you installed the self-extracting RPM file! The <code>-compat</code> package merely performs the same SysV service script set up that the RPM version of the JDK installer does.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Procedure: Installing the JDK on Windows</div>
<ol class="arabic">
<li>
<p>Using Explorer, simply double-click the downloaded self-extracting installer and follow the instructions to install the JDK.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Configuring</div>
<p>Configuring your system for the JDK consists in two tasks: setting the <code class="var">JAVA_HOME</code> environment variable, and ensuring that the system is using the proper JDK (or JRE) using the <code>alternatives</code> command.
Setting <code class="var">JAVA_HOME</code> usually overrides the values for <code>java</code>, <code>javac</code> and <code>java_sdk_1.5.0</code> in <code>alternatives</code>, but we will set them all just to be safe and consistent.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Setting the <code class="var">JAVA_HOME</code> Environment Variable on Generic Linux</dt>
<dd>
<p>After installing the JDK, you must ensure that the <code class="var">JAVA_HOME</code> environment variable exists and points to the location of your JDK installation.</p>
</dd>
<dt class="hdlist1">Setting <code class="var">java</code>, <code class="var">javac</code> and <code class="var">java_sdk_1.5.0</code> Using the <code>alternatives</code> command </dt>
<dd>
<p><em>As the root user</em>, call <code>/usr/sbin/alternatives</code> with the <code class="option">--config java</code> option to select between JDKs and JREs installed on your system:</p>
</dd>
<dt class="hdlist1">Setting the <code class="var">JAVA_HOME</code> Environment Variable on Windows</dt>
<dd>
<p>For information on how to set environment variables in Windows, refer to <a href="http://support.microsoft.com/kb/931715" class="bare">http://support.microsoft.com/kb/931715</a>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<div class="title">Testing</div>
<p>Finally, to make sure that you are using the correct JDK or Java version (5 or higher), and that the java executable is in your <code class="var">PATH</code>, run the `java -version
			` command in the terminal from your home directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>~]$ java -version
java version "1.5.0_16"
Java(TM) 2 Runtime Environment, Standard Edition (build 1.5.0_16-b03)
Java HotSpot(TM) Client VM (build 1.5.0_16-b03, mixed mode, sharing)</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Uninstalling</div>
<p>There is usually no reason (other than space concerns) to remove a particular JDK from your system, given that you can switch between JDKs and JREs easily using <code>alternatives</code>, and/or by setting <code class="var">JAVA_HOME</code>.</p>
</div>
<div class="paragraph">
<div class="title">Uninstalling the JDK on Linux</div>
<p>On RPM-based systems, you can uninstall the JDK using the `yum remove &lt;jdk_rpm_name&gt;
			` command.</p>
</div>
<div class="paragraph">
<div class="title">Uninstalling the JDK on Windows</div>
<p>On Windows systems, check the JDK entry in the <code>Start</code> menu for an uninstall command, or use <code>Add/Remove Programs</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_jboss_home_setup"><a class="anchor" href="#_jboss_home_setup"></a>Appendix B: Setting the JBOSS_HOME Environment Variable</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The [app]` Platform` (<code class="app">) is built on top of the [app]</code>.
You do not need to set the <code class="var">JBOSS_HOME</code> environment variable to run any of the [app]` Platform` servers <em>unless</em> <code class="var">JBOSS_HOME</code> is <em>already</em> set.</p>
</div>
<div class="paragraph">
<p>The best way to know for sure whether <code class="var">JBOSS_HOME</code> was set previously or not is to perform a simple check which may save you time and frustration.</p>
</div>
<div class="paragraph">
<div class="title">Checking to See If JBOSS_HOME is Set on Unix</div>
<p>At the command line, <code>echo</code>			<code>$JBOSS_HOME</code> to see if it is currently defined in your environment:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>~]$ echo $JBOSS_HOME</pre>
</div>
</div>
<div class="paragraph">
<p>The [app]` Platform` and most &amp;THIS.PLATFORM; servers are built on top of the <code class="app"> ([app]</code>). When the [app]` Platform` or &amp;THIS.PLATFORM; servers are built <em>from source</em>, then <code class="var">JBOSS_HOME</code> <em>must</em> be set, because the &amp;THIS.PLATFORM; files are installed into (or &#8220;over top of&#8221; if you prefer) a clean <code class="app"> installation, and the build process assumes that the location pointed to by the <code class="var">JBOSS_HOME</code> environment variable at the time of building is the [app]</code> installation into which you want it to install the &amp;THIS.PLATFORM; files.</p>
</div>
<div class="paragraph">
<p>This guide does not detail building the [app]` Platform` or any &amp;THIS.PLATFORM; servers from source.
It is nevertheless useful to understand the role played by <code class="app">JBoss AS</code> and <code class="var">JBOSS_HOME</code> in the &amp;THIS.PLATFORM; ecosystem.</p>
</div>
<div class="paragraph">
<p>The immediately-following section considers whether you need to set <code class="var">JBOSS_HOME</code> at all and, if so, when.
The subsequent sections detail how to set <code class="var">JBOSS_HOME</code> on Unix and Windows</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
Even if you fall into the category below of <em>not needing</em> to set <code class="var">JBOSS_HOME</code>, you may want to for various reasons anyway.
Also, even if you are instructed that you do <em>not need</em> to set <code class="var">JBOSS_HOME</code>, it is good practice nonetheless to check and make sure that <code class="var">JBOSS_HOME</code> actually <em>isn&#8217;t</em> set or defined on your system for some reason.
This can save you both time and frustration.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You <em>DO NOT NEED</em> to set <code class="var">JBOSS_HOME</code> if&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;you have installed the [app]` Platform` binary distribution.</p>
</li>
<li>
<p>&#8230;&#8203;you have installed a &amp;THIS.PLATFORM;server binary distribution <em>which bundles [app]``.</em></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You <em>MUST</em> set <code class="var">JBOSS_HOME</code> if&#8230;&#8203;</p>
</div>
<div class="ulist">
<ul>
<li>
<p>&#8230;&#8203;you are installing the [app]` Platform` or any of the &amp;THIS.PLATFORM; servers <em>from source</em>.</p>
</li>
<li>
<p>&#8230;&#8203;you are installing the [app]` Platform` binary distribution, or one of the &amp;THIS.PLATFORM; server binary distributions, which <em>do not</em> bundle [app]``.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Naturally, if you installed the [app]` Platform` or one of the &amp;THIS.PLATFORM; server binary releases which <em>do not</em> bundle <code class="app">`, yet requires it to run, then you should install before setting [var]`JBOSS_HOME</code> or proceeding with anything else.</p>
</div>
<div class="paragraph">
<div class="title">Setting the JBOSS_HOME Environment Variable on Unix</div>
<p>The <code class="var">JBOSS_HOME</code> environment variable must point to the directory which contains all of the files for the [app]` Platform` or individual &amp;THIS.PLATFORM; server that you installed.
As another hint, this topmost directory contains a <em class="path">bin</em> subdirectory.</p>
</div>
<div class="paragraph">
<p>Setting <code class="var">JBOSS_HOME</code> in your personal <em class="path">~/.bashrc</em> startup script carries the advantage of retaining effect over reboots.
Each time you log in, the environment variable is sure to be set for you, as a user.
On Unix, it is possible to set <code class="var">JBOSS_HOME</code> as a system-wide environment variable, by defining it in <em class="path">/etc/bashrc</em>, but this method is neither recommended nor detailed in these instructions.</p>
</div>
<div class="olist arabic">
<div class="title">Procedure: To Set JBOSS_HOME on Unix&#8230;&#8203;</div>
<ol class="arabic">
<li>
<p>Open the <em class="path">~/.bashrc</em> startup script, which is a hidden file in your home directory, in a text editor, and insert the following line on its own line while substituting for the actual install location on your system:</p>
<div class="listingblock">
<div class="content">
<pre>export JBOSS_HOME="/home/&lt;username&gt;/&lt;path&gt;/&lt;to&gt;/&lt;install_directory&gt;"</pre>
</div>
</div>
</li>
<li>
<p>Save and close the <em class="path">.bashrc</em> startup script.</p>
</li>
<li>
<p>You should <code>source</code> the <em class="path">.bashrc</em> script to force your change to take effect, so that <code class="var">JBOSS_HOME</code> becomes set for the current session<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnote_2" title="View footnote.">2</a>]</sup>.</p>
<div class="listingblock">
<div class="content">
<pre>~]$ source ~/.bashrc</pre>
</div>
</div>
</li>
<li>
<p>Finally, ensure that <code class="var">JBOSS_HOME</code> is set in the current session, and actually points to the correct location:</p>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The command line usage below is based upon a binary installation of the [app]` Platform`.
In this sample output, <code class="var">JBOSS_HOME</code> has been set correctly to the <code class="replaceable">topmost_directory</code> of the <code class="app"> installation.
Note that if you are installing one of the standalone [app]</code> servers (with <code class="app">JBoss AS</code> bundled!), then <code class="var">JBOSS_HOME</code> would point to the <code class="replaceable">topmost_directory</code> of your server installation.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>~]$ echo $JBOSS_HOME
/home/silas/&lt;path&gt;/&lt;to&gt;/&lt;install_directory&gt;</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Setting the JBOSS_HOME Environment Variable on Windows</div>
<p>The <code class="var">JBOSS_HOME</code> environment variable must point to the directory which contains all of the files for the &amp;THIS.PLATFORM;Platform or individual &amp;THIS.PLATFORM;server that you installed.
As another hint, this topmost directory contains a <em class="path">bin</em> subdirectory.</p>
</div>
<div class="paragraph">
<p>For information on how to set environment variables in recent versions of Windows, refer to <a href="http://support.microsoft.com/kb/931715" class="bare">http://support.microsoft.com/kb/931715</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_fault_tolerant_cluster_example"><a class="anchor" href="#_fault_tolerant_cluster_example"></a>Appendix C: Fault Tolerant Clustering - A Concrete Example</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In order to highlight the behavior of the Restcomm JAIN SLEE server when run in fault tolerant clustering mode, a concrete situation is described below.</p>
</div>
<div class="sect2">
<h3 id="_ft_example_overview"><a class="anchor" href="#_ft_example_overview"></a>Example Overview</h3>
<div class="paragraph">
<p>The example below outlines a situation where two Restcomm JAIN SLEE nodes (<code>Node-1</code> and <code>Node-2</code>) are configured to run in fault tolerant mode.
Both nodes have the same deployable unit containing a custom .
A null activity  is used by the s to communicate.</p>
</div>
<div class="paragraph">
<p>The service is a simple application that relays information received in  INFO messages to another incoming  dialog.
This might for example be a rudimentary chat application.
The flow outlines the clustered execution of the base case of this application, e.g.
receive one message on one dialog and send it out on another dialog.</p>
</div>
<div class="paragraph">
<p>The example starts with the creation of two  entities.
One of the entities is the receiver, and the other one is the sender.
The receiver will create an  and register this with the  naming facility.
The sender retrieves the  and sends a message to the receiver using an event.
The example ends when the receiver sends the acquired message on its  dialog as an INFO message.</p>
</div>
</div>
<div class="sect2">
<h3 id="_ft_example_step1"><a class="anchor" href="#_ft_example_step1"></a>Creating Sbb entities</h3>
<div class="paragraph">
<p>The base case starts with a  INVITE being received in <code>Node-1</code>.
The event will be routed inside <code>Node-1</code> and trigger the creation of a new  entity (<code>Sbb-1</code>). The  entity in turn create and attach to a new null activity  (<code>ACI-1</code>). Concurrently another  INVITE is received in <code>Node-2</code>, which causes the JAIN SLEE container to create another  entity (<code>Sbb-2</code>). Both s and s are fully clustered, so even though they are created in different physical nodes, they are logically inside the same container.
In the image below, the cloud represents this logical relationship.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Note that balancer is not a requirement.
It is present in this example to show basic message flow with balancer in front of deployed containers.
</td>
</tr>
</table>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/slee-clustering1.png" alt="slee clustering1">
</div>
<div class="title">Figure 4. Fault tolerant cluster consisting of two nodes that both have one created on SBB entity for chat application. The SIP load balancer is multiplexing the SIP traffic.</div>
</div>
</div>
<div class="sect2">
<h3 id="_ft_example_step2"><a class="anchor" href="#_ft_example_step2"></a>Relaying the Message</h3>
<div class="paragraph">
<p>After the s have been set up, a  INFO is received by <code>Node-2</code> and relayed to <code>Sbb-2</code>. <code>Sbb-2</code> then looks up <code>ACI-1</code> from the ACI naming facility. <code>Node-2</code> retrieves the clustered state of <code>ACI-1</code> and de-serializes it for <code>Sbb-2</code>.
Note that this means that <code>ACI-1</code> is currently being handled in <code>Node-2</code>.</p>
</div>
<div class="paragraph">
<p>When <code>ACI-1</code> has been retrieved from the cluster, <code>Sbb-2</code> fires a MessageEvent on <code>ACI-1</code>.
Since events are not clustered, the event will be routed only on <code>Node-2</code>.
The event will, however, be delivered to all attached s.
This is achieved by <code>Node-2</code> retrieving the <code>Sbb-1</code> entity from the cluster and delivering the event to it.</p>
</div>
<div class="paragraph">
<p>The MessageEvent is parsed by <code>Sbb-1</code> and an outgoing  INFO message is constructed with the appropriate payload. <code>Sbb-1</code> then forwards the INFO message to the SipRA.
The incoming  dialog that spawned <code>Sbb-1</code> is in <code>Node-1</code>, hence the SipRA will retrieve the activity object from the cluster and send the INFO message.
The  load balancer will then handle de-multiplexing.
Note that retrieving the activity object from the clustered state only works because the SipRA is explicitly handling the replication of the SIP activity objects.
Had another  than the SipRA been used, a similar kind of clustering would have been needed to be implemented using the <code>FaultTolerantResourceAdaptor</code> interfaces.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/slee-clustering2.png" alt="slee clustering2">
</div>
<div class="title">Figure 5. The situation when relaying the INFO message. Both SBB entities are running in the same node.</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="revision-history"><a class="anchor" href="#revision-history"></a>Appendix D: Revision History</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnote_1">
<a href="#_footnoteref_1">1</a>. At this point in time, it is possible to run most  servers, such as the JAIN SLEE, using a Java 6 JRE or JDK. Be aware, however, that presently the XML Document Management Server does not run on Java 6. We suggest checking the  web site, forums or discussion pages if you need to inquire about the status of running the XML Document Management Server with Java 6.
</div>
<div class="footnote" id="_footnote_2">
<a href="#_footnoteref_2">2</a>. Note that any other terminals which were opened prior to your having altered .bashrc will need to source ~/.bashrc as well should they require access to JBOSS_HOME.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-04-28 10:40:54 WEST
</div>
</div>
</body>
</html>